<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÂÜ∞Â±øËµ∑ÂßãÈ°µ</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ùÑÔ∏è</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --theme-color: #00d4ff;
      --bg-dark: rgba(30, 30, 40, 0.85);
      --bg-darker: rgba(20, 20, 30, 0.95);
      --bg-card: rgba(40, 40, 55, 0.9);
      --bg-card-hover: rgba(50, 50, 65, 0.95);
      --text-primary: rgba(255, 255, 255, 0.95);
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-muted: rgba(255, 255, 255, 0.5);
      --border: rgba(255, 255, 255, 0.1);
      --shadow: rgba(0, 0, 0, 0.3);
      --app-version: "1.0.0";
    }





    :root {
      --theme-color: #00d4ff;
      --bg-dark: rgba(30, 30, 40, 0.85);
      --bg-darker: rgba(20, 20, 30, 0.95);
      --bg-card: rgba(40, 40, 55, 0.9);
      --bg-card-hover: rgba(50, 50, 65, 0.95);
      --text-primary: rgba(255, 255, 255, 0.95);
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-muted: rgba(255, 255, 255, 0.5);
      --border: rgba(255, 255, 255, 0.1);
      --shadow: rgba(0, 0, 0, 0.3);
      --app-version: "1.0.0";
    }

    /* ÊµÖËâ≤Ê®°Âºè */
    body.light-mode {
      --bg-dark: rgba(255, 255, 255, 0.85);
      --bg-darker: rgba(245, 245, 250, 0.95);
      --bg-card: rgba(255, 255, 255, 0.9);
      --bg-card-hover: rgba(250, 250, 255, 0.95);
      --text-primary: rgba(30, 30, 40, 0.95);
      --text-secondary: rgba(50, 50, 60, 0.8);
      --text-muted: rgba(100, 100, 120, 0.7);
      --border: rgba(0, 0, 0, 0.1);
      --shadow: rgba(0, 0, 0, 0.1);
    }

    body.light-mode {
      background: #f0f2f5;
    }






    
    body.light-mode .clock {
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    body.light-mode .vignette-layer {
      background: radial-gradient(ellipse at center, transparent 0%, rgba(255,255,255,0.3) 100%);
    }

    body.light-mode .dock-bar {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(0, 0, 0, 0.08);
    }

    body.light-mode .workspace-item {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(0, 0, 0, 0.06);
    }

    body.light-mode .workspace-item:hover {
      background: rgba(255, 255, 255, 0.8);
    }

    body.light-mode .search-box {
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    body.light-mode .search-input {
      color: var(--text-primary);
    }

    body.light-mode .search-input::placeholder {
      color: var(--text-muted);
    }

    body.light-mode .pinned-note {
      background: rgba(255, 255, 255, 0.8);
    }

    


    body.light-mode .pinned-notes::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.15);
    }

    body.light-mode .pinned-notes::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 0, 0, 0.25);
    }

    body.light-mode .pinned-notes {
      scrollbar-color: rgba(0, 0, 0, 0.15) transparent;
    }

    body.light-mode .pinned-notes-toggle {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-left: none;
    }




    body.light-mode .top-btn {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(0, 0, 0, 0.08);
    }

    body {
      font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
      min-height: 100vh;
      background: #1a1a2e;
      color: var(--text-primary);
      overflow-x: hidden;
      position: relative;
    }

    /* ËÉåÊôØÂõæÁâá */
    .background-layer {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: -2;
      transition: opacity 0.5s ease;
    }

    /* ÊöóËßíÊª§Èïú */
    .vignette-layer {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.4) 100%);
      z-index: -1;
      pointer-events: none;
    }

    /* ‰∏ªÂÆπÂô® */
    .main-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      /* justify-content: center; */
      justify-content: flex-start;  /* ‰ªéÈ°∂ÈÉ®ÂºÄÂßã */
      padding: 2rem;
      padding-top: 13vh;            /* Ë∑ùÁ¶ªÈ°∂ÈÉ®15%ËßÜÁ™óÈ´òÂ∫¶ÔºåÂèØËá™Ë°åË∞ÉÊï¥ */
      
      position: relative;
    }

    /* ‰æøÁ≠æÂõ∫ÂÆöÂú®Â∑¶‰∏äËßí - Â§ñÂ±ÇÂÆπÂô® */
    .pinned-notes-wrapper {
      position: fixed;
      top: 20px;
      left: 0;
      z-index: 100;
      display: flex;
      align-items: flex-start;
      transition: transform 0.3s ease;
    }

    .pinned-notes-wrapper.collapsed {
      transform: translateX(-300px);
    }

    /* Êî∂Á∫≥ÂàáÊç¢ÊåâÈíÆ */
    .pinned-notes-toggle {
      width: 24px;
      height: 50px;
      background: rgba(30, 30, 40, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      border-left: none;
      border-radius: 0 8px 8px 0;
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .pinned-notes-toggle:hover {
      background: rgba(40, 40, 55, 0.8);
      color: var(--text-primary);
    }

    .pinned-notes-toggle svg {
      width: 14px;
      height: 14px;
      transition: transform 0.3s ease;
    }

    .pinned-notes-wrapper.collapsed .pinned-notes-toggle svg {
      transform: rotate(180deg);
    }

    /* ‰æøÁ≠æÂÆπÂô® */
    .pinned-notes {
      margin-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-width: 280px;  /* ‚úÖ ÂÖ≥ÈîÆ‰øÆÂ§çÔºöËÆæÁΩÆÊúÄÂ∞èÂÆΩÂ∫¶ */
      max-width: 280px;
      max-height: calc(100vh - 40px);
      overflow-y: auto;
      padding-right: 8px;
    }

    /* ÁæéÂåñÊªöÂä®Êù° */
    .pinned-notes::-webkit-scrollbar {
      width: 6px;
    }

    .pinned-notes::-webkit-scrollbar-track {
      background: transparent;
    }

    .pinned-notes::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
    }

    .pinned-notes::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    /* Firefox ÊªöÂä®Êù° */
    .pinned-notes {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.15) transparent;
    }

    .pinned-note {
      background: rgba(30, 30, 40, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      padding: 12px;
      font-size: 0.85rem;
      color: var(--text-secondary);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .pinned-note:hover {
      background: rgba(40, 40, 55, 0.8);
    }

    .pinned-note-title {
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 8px;
      padding-bottom: 6px;
      border-bottom: 1px solid var(--border);
    }

    .pinned-note-content {
      font-size: 0.8rem;
      /* ‰øùÊåÅÊç¢Ë°åÂπ∂‰øùÁïôÊç¢Ë°åÁ¨¶Ôºå‰ΩÜÂÖÅËÆ∏Âú®ÂøÖË¶ÅÊó∂Êç¢Ë°åÈïøÂçïËØç */
      white-space: pre-wrap;
      /* ÂÖÅËÆ∏Âú®ÂøÖË¶ÅÊó∂ÂØπÈïøÂçïËØçÔºàÂ¶ÇËøûÁª≠Â≠óÊØç/Á¨¶Âè∑ÔºâËøõË°åÊç¢Ë°åÔºåÈò≤Ê≠¢Ê∫¢Âá∫ */
      overflow-wrap: anywhere;
      /* ÂÖºÂÆπÊóßÊµèËßàÂô® */
      word-wrap: break-word;
      /* ‰øùÊåÅÂØπ‰∏≠/Ëã±Á≠âËØ≠Ë®ÄÁöÑÈªòËÆ§Êç¢Ë°åË°å‰∏∫ÔºàÊØî break-all Ê∏©ÂíåÔºâ */
      word-break: normal;
      /* ÂêØÁî®ËøûÂ≠óÁ¨¶ÔºàÂØπ‰∫éËã±ÊñáÂçïËØçÂú®‰∏≠Èó¥Êñ≠ÂºÄÊó∂Êõ¥ÁæéËßÇÔºâ */
      hyphens: auto;
      box-sizing: border-box;
      max-width: 100%;
      font-family: inherit;
      line-height: 1.6;
      color: var(--text-secondary);
    }

    .pinned-note-date {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-top: 8px;
      padding-top: 6px;
      border-top: 1px solid var(--border);
    }

    /* Âè≥‰∏äËßíÊåâÈíÆ */
    .top-right-buttons {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 12px;
      z-index: 100;
    }

    .top-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(40, 40, 55, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .top-btn:hover {
      background: rgba(50, 50, 65, 0.8);
      color: var(--text-primary);
    }

    .top-btn svg {
      width: 18px;
      height: 18px;
    }

    /* Êó∂Èíü */
    .clock-section {
      text-align: center;
      margin-bottom: 2rem;
    }

    .clock {
      font-size: 5rem;
      font-weight: 300;
      letter-spacing: 0.05em;
      color: var(--text-primary);
      text-shadow: 0 2px 20px rgba(0,0,0,0.3);
    }

    /* ÊêúÁ¥¢Ê°ÜÂå∫Âüü */
    .search-section {
      width: 100%;
      max-width: 600px;
      margin-bottom: 2rem;
    }

    .search-container {
      position: relative;
    }

    .search-box {
      display: flex;
      align-items: center;
      background: var(--bg-dark);
      backdrop-filter: blur(20px);
      border-radius: 12px;
      border: 1px solid var(--border);
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .search-box:focus-within {
      border-color: var(--theme-color);
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
    }

    .search-engine-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 14px 16px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
      border-right: 1px solid var(--border);
    }

    .search-engine-btn:hover {
      background: rgba(255,255,255,0.05);
    }

    .search-engine-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .search-input {
      flex: 1;
      padding: 14px 16px;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 1rem;
      font-family: inherit;
      outline: none;
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .search-submit-btn {
      padding: 14px 18px;
      background: transparent;
      border: none;
      color: var(--theme-color);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .search-submit-btn:hover {
      background: rgba(0, 212, 255, 0.1);
    }

    .search-submit-btn svg {
      width: 20px;
      height: 20px;
    }

    /* ÊêúÁ¥¢ÂºïÊìé‰∏ãÊãâËèúÂçï */
    .search-engine-dropdown {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      background: var(--bg-darker);
      backdrop-filter: blur(20px);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 8px 0;
      min-width: 220px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 1000;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }

    .search-engine-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .engine-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
    }

    .engine-option:hover {
      background: rgba(255,255,255,0.05);
      color: var(--text-primary);
    }

    .engine-option.active {
      color: var(--theme-color);
    }

    .engine-option-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }

    .engine-option-name {
      flex: 1;
    }

    .engine-option-shortcut {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .engine-dropdown-divider {
      height: 1px;
      background: var(--border);
      margin: 8px 0;
    }

    .engine-settings-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-muted);
    }

    .engine-settings-option:hover {
      background: rgba(255,255,255,0.05);
      color: var(--text-secondary);
    }

    /* ‰∏ÄË®Ä */
    .hitokoto-section {
      text-align: center;
      margin-top: 33rem;
      margin-bottom: 2rem;
    }

    .hitokoto {
      font-size: 1rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 8px 16px;
      border-radius: 20px;
    }

    .hitokoto:hover {
      color: var(--text-primary);
      background: rgba(255,255,255,0.05);
    }

    /* Â∫ïÈÉ®Âø´Êç∑Ê†è */
    .dock-bar {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(30, 30, 40, 0.7);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      border: 1px solid var(--border);
      z-index: 100;
    }

    .dock-item {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: white;
      font-size: 20px;
      position: relative;
    }

    .dock-item:hover {
      transform: translateY(-8px) scale(1.1);
    }

    .dock-item::after {
      content: attr(data-title);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-darker);
      color: var(--text-primary);
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.75rem;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
    }

    .dock-item:hover::after {
      opacity: 1;
      visibility: visible;
    }





    /* ===== DockÊãñÊãΩÁõ∏ÂÖ≥Ê†∑Âºè ===== */
    .dock-item.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    .dock-item.shake {
      animation: dockShake 0.1s ease-in-out infinite;
    }

    @keyframes dockShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      75% { transform: translateX(3px); }
    }

    .dock-item.drag-over {
      filter: brightness(1.2);
    }










    /* Â∑•‰ΩúÂå∫ÂüüÔºàÂè≥ÈîÆËèúÂçïÊâìÂºÄÔºâ- ÁéªÁíÉË¥®ÊÑüÈÄèÊòé */
    .workspace-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(20, 20, 30, 0.3);
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
      z-index: 500;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 60px 40px;
      overflow-y: auto;
    }

    .workspace-overlay::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
      pointer-events: none;
    }

    .workspace-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .workspace-clock {
      font-size: 4rem;
      font-weight: 300;
      color: var(--text-primary);
      margin-bottom: 40px;
      position: relative;
      z-index: 1;
    }

    .workspace-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 20px;
      max-width: 900px;
      width: 100%;
      position: relative;
      z-index: 1;
    }

    .workspace-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-primary);
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }

    .workspace-item:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-4px);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .workspace-item.dragging {
      opacity: 0.5;
      transform: scale(1.05);
    }

    .workspace-item.drag-over {
      border-color: var(--theme-color);
      background: rgba(0, 212, 255, 0.1);
    }

    .workspace-item-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
    }

    .workspace-item-name {
      font-size: 0.85rem;
      color: var(--text-secondary);
      text-align: center;
    }

    .workspace-item-delete {
      position: absolute;
      top: -8px;
      right: -8px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(239, 68, 68, 0.9);
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: white;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: all 0.2s ease;
      z-index: 10;
    }

    .workspace-item:hover .workspace-item-delete {
      display: flex;
    }

    .workspace-item-delete:hover {
      background: #ef4444;
      transform: scale(1.1);
    }

    .workspace-add-item {
      border: 2px dashed rgba(255, 255, 255, 0.2);
      background: transparent;
    }

    .workspace-add-item:hover {
      border-color: var(--theme-color);
      background: rgba(0, 212, 255, 0.05);
    }

    .workspace-add-icon {
      font-size: 28px;
      color: var(--text-muted);
    }

    /* Âè≥ÈîÆËèúÂçï */
    .context-menu {
      position: fixed;
      background: rgba(30, 30, 40, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 8px 0;
      min-width: 180px;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transform: scale(0.9);
      transition: all 0.2s ease;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    }

    .context-menu.show {
      opacity: 1;
      visibility: visible;
      transform: scale(1);
    }

    .context-menu-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
    }

    .context-menu-item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-primary);
    }

    .context-menu-item.danger {
      color: #ef4444;
    }

    .context-menu-item.danger:hover {
      background: rgba(239, 68, 68, 0.1);
    }

    .context-menu-divider {
      height: 1px;
      background: var(--border);
      margin: 8px 0;
    }

    /* ËÆæÁΩÆÈù¢Êùø */
    .settings-panel {
      position: fixed;
      top: 0;
      right: 0;
      width: 100%;
      max-width: 500px;
      height: 100vh;
      background: var(--bg-darker);
      z-index: 1000;
      transform: translateX(100%);
      transition: transform 0.4s ease;
      overflow-y: auto;
      border-left: 1px solid var(--border);
    }


    /* ËÆæÁΩÆÈù¢ÊùøÊªöÂä®Êù°ÁæéÂåñ */
    .settings-panel::-webkit-scrollbar {
      width: 6px;
    }

    .settings-panel::-webkit-scrollbar-track {
      background: transparent;
    }

    .settings-panel::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
    }

    .settings-panel::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    /* Firefox ÊªöÂä®Êù° */
    .settings-panel {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.15) transparent;
    }




    .settings-panel.show {
      transform: translateX(0);
    }

    .settings-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .settings-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px;
      border-bottom: 1px solid var(--border);
    }

    .settings-title {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .settings-close {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .settings-close:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-primary);
    }

    .settings-content {
      padding: 24px;
    }

    .settings-section {
      margin-bottom: 32px;
    }

    .settings-section-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--text-primary);
    }

    .settings-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 8px;
    }

    .settings-item-label {
      color: var(--text-secondary);
    }

    .settings-item-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* Toggle ÂºÄÂÖ≥ */
    .toggle {
      width: 48px;
      height: 26px;
      background: rgba(255,255,255,0.1);
      border-radius: 13px;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .toggle.active {
      background: var(--theme-color);
    }

    .toggle::after {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: all 0.3s ease;
    }

    .toggle.active::after {
      left: 24px;
    }

    /* È¢úËâ≤ÈÄâÊã©Âô® */
    .color-options {
      display: flex;
      gap: 12px;
    }

    .color-option {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 2px solid transparent;
    }

    .color-option:hover {
      transform: scale(1.1);
    }

    .color-option.active {
      border-color: white;
    }

    .color-option.green { background: #4ade80; }
    .color-option.cyan { background: #00d4ff; }
    .color-option.purple { background: #a78bfa; }
    .color-option.pink { background: #f472b6; }
    .color-option.blue { background: #3b82f6; }

    /* Â£ÅÁ∫∏ÈÄâÊã©Âô® */
    .wallpaper-section {
      margin-top: 20px;
    }

    .wallpaper-upload-area {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 20px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 16px;
    }

    .wallpaper-preview {
      width: 80px;
      height: 60px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      overflow: hidden;
    }

    .wallpaper-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .wallpaper-upload-info h4 {
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .wallpaper-upload-info p {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .wallpaper-actions {
      display: flex;
      gap: 12px;
      margin-top: 12px;
    }

    .wallpaper-action-btn {
      padding: 8px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .wallpaper-action-btn:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-primary);
    }

    .wallpaper-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .wallpaper-item {
      aspect-ratio: 16/10;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      border: 2px solid transparent;
    }

    .wallpaper-item:hover {
      transform: scale(1.05);
    }

    .wallpaper-item.active {
      border-color: var(--theme-color);
    }

    .wallpaper-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .wallpaper-item .check-icon {
      position: absolute;
      bottom: 6px;
      right: 6px;
      width: 20px;
      height: 20px;
      background: var(--theme-color);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .wallpaper-item.active .check-icon {
      display: flex;
    }

    /* ‰æøÁ≠æÂºπÁ™ó */
    /* .notes-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      background: var(--bg-darker);
      border-radius: 16px;
      border: 1px solid var(--border);
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
    } */

    .notes-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      height: 70vh;
      min-width: 400px;
      min-height: 300px;
      max-height: 95vh;
      background: var(--bg-darker);
      border-radius: 16px;
      border: 1px solid var(--border);
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      /* transition: opacity 0.3s ease, visibility 0.3s ease; */
      transition: opacity 0.3s ease, visibility 0.3s ease, border-radius 0.3s ease;
      display: flex;
      flex-direction: column;
      resize: both;
      overflow: hidden;
    }



    .notes-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .notes-modal.fullscreen {
      width: 100% !important;
      max-width: 100% !important;
      height: 100vh !important;
      max-height: 100vh !important;
      min-width: 100% !important;
      min-height: 100vh !important;
      border-radius: 0 !important;
      top: 0 !important;
      left: 0 !important;
      transform: none !important;
      resize: none;
      transition: all 0.3s ease !important;
    }
    
    .notes-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
    }

    .notes-modal-title {
      font-size: 1.1rem;
      font-weight: 500;
    }

    .notes-modal-actions {
      display: flex;
      gap: 8px;
    }

    .notes-modal-btn {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      background: transparent;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .notes-modal-btn:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-secondary);
    }

    .notes-modal-btn.active {
      background: rgba(0, 212, 255, 0.2);
      color: var(--theme-color);
    }

    .notes-modal-body {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    .notes-sidebar {
      width: 220px;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .notes-sidebar-header {
      padding: 12px;
      border-bottom: 1px solid var(--border);
    }

    .notes-list {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }

    .notes-folder {
      margin-bottom: 12px;
    }

    .notes-folder-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    .notes-folder-header:hover {
      background: rgba(255,255,255,0.05);
    }

    .notes-folder-header.collapsed .folder-arrow {
      transform: rotate(-90deg);
    }

    .folder-arrow {
      font-size: 0.7rem;
      transition: transform 0.2s ease;
    }

    .notes-folder-content {
      padding-left: 12px;
    }

    .notes-folder-content.collapsed {
      display: none;
    }

    .notes-list-item {
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 6px;
      transition: all 0.2s ease;
      position: relative;
    }

    .notes-list-item:hover {
      background: rgba(255,255,255,0.05);
    }

    .notes-list-item.active {
      background: rgba(0, 212, 255, 0.1);
      border-left: 2px solid var(--theme-color);
    }

    .notes-list-item.dragging {
      opacity: 0.5;
    }

    .notes-list-item.drag-over {
      border: 1px dashed var(--theme-color);
    }

    .notes-list-item-title {
      font-size: 0.85rem;
      color: var(--text-primary);
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .notes-list-item-date {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .notes-add-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      background: rgba(0, 212, 255, 0.1);
      border: none;
      border-radius: 8px;
      color: var(--theme-color);
      cursor: pointer;
      width: 100%;
      font-size: 0.85rem;
      transition: all 0.2s ease;
    }

    .notes-add-btn:hover {
      background: rgba(0, 212, 255, 0.2);
    }

    .notes-add-folder-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: transparent;
      border: 1px dashed var(--border);
      border-radius: 8px;
      color: var(--text-muted);
      cursor: pointer;
      width: 100%;
      font-size: 0.8rem;
      transition: all 0.2s ease;
      margin-top: 8px;
    }

    .notes-add-folder-btn:hover {
      background: rgba(255,255,255,0.05);
      color: var(--text-secondary);
    }

    /* .notes-editor {
      flex: 1;
      padding: 20px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    } */

    .notes-editor {
      flex: 1;
      padding: 20px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      min-height: 0;
    }

    .notes-editor-placeholder {
      color: var(--text-muted);
      text-align: center;
      padding: 40px;
    }

    /* .notes-editor textarea {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 0.95rem;
      line-height: 1.8;
      resize: none;
      outline: none;
      font-family: 'Noto Sans SC', monospace;
      white-space: pre-wrap;
      tab-size: 2;
    } */
    /* .notes-editor textarea {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 0.95rem;
      line-height: 1.8;
      resize: none;
      outline: none;
      font-family: 'Noto Sans SC', monospace;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: anywhere;
      word-break: normal;
      tab-size: 2;
      width: 100%;
      max-width: 100%;
    } */


    .notes-editor textarea {
      flex: none;
      height: 50%;
      min-height: 80px;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 0.95rem;
      line-height: 1.8;
      resize: none;
      outline: none;
      font-family: 'Noto Sans SC', monospace;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: anywhere;
      word-break: normal;
      tab-size: 2;
      width: 100%;
      max-width: 100%;
      overflow-y: auto;
    }

    .notes-editor textarea::placeholder {
      color: var(--text-muted);
    }









        /* ‰ªªÂä°ÂàóË°®Ê†∑Âºè */
    /* .task-list {
      margin-top: 16px;
      border-top: 1px solid var(--border);
      padding-top: 12px;
    } */


    .task-list {
      flex: 1;
      min-height: 100px;
      display: flex;
      flex-direction: column;
      border-top: none;
      padding-top: 0;
      overflow: hidden;
    }

    .task-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .task-list-title {
      font-size: 0.85rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    .add-task-btn {
      padding: 4px 12px;
      background: rgba(0, 212, 255, 0.1);
      border: none;
      border-radius: 6px;
      color: var(--theme-color);
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.2s ease;
    }

    .add-task-btn:hover {
      background: rgba(0, 212, 255, 0.2);
    }

    /* .task-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
    } */

    .task-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
      overflow-y: auto;
      padding-right: 4px;
    }


    .task-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 12px;
      background: var(--bg-card);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .task-item:hover {
      background: var(--bg-card-hover);
    }

    .task-item.selected {
      outline: 2px solid var(--theme-color);
    }

    .task-item.completed .task-text {
      text-decoration: line-through;
      color: var(--text-muted);
    }

    .task-checkbox {
      width: 18px;
      height: 18px;
      min-width: 18px;
      border: 2px solid var(--text-muted);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 2px;
    }

    .task-checkbox:hover {
      border-color: var(--theme-color);
    }

    .task-item.completed .task-checkbox {
      background: var(--theme-color);
      border-color: var(--theme-color);
    }

    .task-checkbox svg {
      width: 12px;
      height: 12px;
      stroke: white;
      opacity: 0;
    }

    .task-item.completed .task-checkbox svg {
      opacity: 1;
    }

    .task-content {
      flex: 1;
      min-width: 0;
    }

    .task-text {
      color: var(--text-primary);
      font-size: 0.9rem;
      word-wrap: break-word;
      overflow-wrap: anywhere;
    }

    .task-input {
      width: 100%;
      padding: 8px 12px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-primary);
      font-size: 0.9rem;
      outline: none;
      font-family: inherit;
    }

    .task-input:focus {
      border-color: var(--theme-color);
    }

    /* Âõ∫ÂÆö‰æøÁ≠æ‰∏≠ÁöÑ‰ªªÂä°ÂàóË°®Ê†∑Âºè */
    .pinned-note-tasks {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px dashed var(--border);
    }

    .pinned-task-item {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 0.75rem;
      margin-bottom: 4px;
      color: var(--text-secondary);
    }

    .pinned-task-item.completed {
      text-decoration: line-through;
      color: var(--text-muted);
    }

    .pinned-task-checkbox {
      width: 12px;
      height: 12px;
      min-width: 12px;
      border: 1.5px solid var(--text-muted);
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 1px;
    }

    .pinned-task-item.completed .pinned-task-checkbox {
      background: var(--theme-color);
      border-color: var(--theme-color);
    }


    /* ==================== ÊöóËâ≤Á≥ªÊªöÂä®Êù°Ê†∑Âºè ==================== */
    /* ‰æøÁ≠æÁºñËæëÂô®Âíå‰ªªÂä°ÂàóË°®ÁöÑÊªöÂä®Êù° */
    .notes-editor::-webkit-scrollbar,
    .notes-editor textarea::-webkit-scrollbar,
    .task-items::-webkit-scrollbar,
    .notes-list::-webkit-scrollbar,
    .notes-modal-body::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .notes-editor::-webkit-scrollbar-track,
    .notes-editor textarea::-webkit-scrollbar-track,
    .task-items::-webkit-scrollbar-track,
    .notes-list::-webkit-scrollbar-track,
    .notes-modal-body::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .notes-editor::-webkit-scrollbar-thumb,
    .notes-editor textarea::-webkit-scrollbar-thumb,
    .task-items::-webkit-scrollbar-thumb,
    .notes-list::-webkit-scrollbar-thumb,
    .notes-modal-body::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 4px;
      transition: background 0.2s ease;
    }

    .notes-editor::-webkit-scrollbar-thumb:hover,
    .notes-editor textarea::-webkit-scrollbar-thumb:hover,
    .task-items::-webkit-scrollbar-thumb:hover,
    .notes-list::-webkit-scrollbar-thumb:hover,
    .notes-modal-body::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    .notes-editor::-webkit-scrollbar-corner,
    .notes-editor textarea::-webkit-scrollbar-corner,
    .task-items::-webkit-scrollbar-corner {
      background: transparent;
    }

    /* Firefox ÊªöÂä®Êù°Ê†∑Âºè */
    .notes-editor,
    .notes-editor textarea,
    .task-items,
    .notes-list,
    .notes-modal-body {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.15) rgba(255, 255, 255, 0.05);
    }

    /* ==================== ÊãñÊãΩÂàÜÈöîÊù°Ê†∑Âºè ==================== */
    .editor-resize-handle {
      height: 12px;
      min-height: 12px;
      background: transparent;
      cursor: ns-resize;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px 0;
      border-radius: 4px;
      transition: background 0.2s ease;
      position: relative;
    }

    .editor-resize-handle:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .editor-resize-handle::before {
      content: '';
      width: 40px;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      transition: all 0.2s ease;
    }

    .editor-resize-handle:hover::before {
      background: var(--theme-color);
      width: 60px;
    }

    .editor-resize-handle:active {
      background: rgba(0, 212, 255, 0.1);
    }

    .editor-resize-handle:active::before {
      background: var(--theme-color);
    }

    /* ÊãñÊãΩÊó∂Á¶ÅÁî®ÊñáÊú¨ÈÄâÊã© */
    .notes-editor.resizing {
      user-select: none;
    }

    .notes-editor.resizing textarea,
    .notes-editor.resizing .task-list {
      pointer-events: none;
    }


    

    /* Ê∑ªÂä†Á´ôÁÇπÂºπÁ™ó */
    .add-site-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 400px;
      background: var(--bg-darker);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 24px;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .add-site-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .add-site-modal h3 {
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .form-group input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 0.95rem;
      outline: none;
      transition: all 0.2s ease;
    }

    .form-group input:focus {
      border-color: var(--theme-color);
    }

    .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .btn {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      transition: all 0.2s ease;
    }

    .btn-primary {
      background: var(--theme-color);
      color: white;
    }

    .btn-primary:hover {
      filter: brightness(1.1);
    }

    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: var(--text-secondary);
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.15);
    }

    /* ‰∏ÄË®ÄËÆæÁΩÆÂºπÁ™ó */
    .hitokoto-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 500px;
      background: var(--bg-darker);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 24px;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .hitokoto-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .hitokoto-list {
      margin: 16px 0;
    }

    .hitokoto-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-card);
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .hitokoto-item-text {
      flex: 1;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .hitokoto-item-delete {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      background: transparent;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .hitokoto-item-delete:hover {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }

    .hitokoto-add-form {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }

    .hitokoto-add-form input {
      flex: 1;
      padding: 10px 14px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      outline: none;
    }

    .hitokoto-add-form button {
      padding: 10px 20px;
      background: var(--theme-color);
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
    }

    /* Ê∑ªÂä†Êñá‰ª∂Â§πÂºπÁ™ó */
    .add-folder-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 350px;
      background: var(--bg-darker);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 24px;
      z-index: 1002;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .add-folder-modal.show {
      opacity: 1;
      visibility: visible;
    }

    /* Êï∞ÊçÆÁÆ°ÁêÜÊåâÈíÆÊ†∑Âºè */
    .data-management-btns {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .data-btn {
      padding: 8px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .data-btn:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-primary);
    }

    .data-btn.danger {
      border-color: rgba(239, 68, 68, 0.3);
    }

    .data-btn.danger:hover {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }

    /* Toast ÊèêÁ§∫ */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: var(--bg-darker);
      color: var(--text-primary);
      padding: 12px 24px;
      border-radius: 8px;
      border: 1px solid var(--border);
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .toast.show {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }

    .toast.success {
      border-color: #4ade80;
    }

    .toast.error {
      border-color: #ef4444;
    }

    /* ÁâàÊú¨‰ø°ÊÅØ */
    .version-info {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 8px;
    }



    /* ========== ÂÖ≥‰∫éÂºπÁ™ó ========== */
    .about-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }




    .about-modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    /* .about-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      max-width: 90%;
      max-height: 80vh;
      background: linear-gradient(180deg, rgba(35, 40, 55, 0.98) 0%, rgba(25, 28, 40, 0.98) 100%);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
      z-index: 2001;
      opacity: 0;
      visibility: hidden;
      transform: translate(-50%, -50%) scale(0.9);
      transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    } */




    .about-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      max-width: 90%;
      height: 75vh;              /* üîß ÂÖ≥ÈîÆ‰øÆÊîπÔºöÊîπ‰∏∫Âõ∫ÂÆöÈ´òÂ∫¶ */
      max-height: 700px;         /* üîß Êñ∞Â¢ûÔºöÊúÄÂ§ßÈ´òÂ∫¶ÈôêÂà∂ */
      min-height: 400px;         /* üîß Êñ∞Â¢ûÔºöÊúÄÂ∞èÈ´òÂ∫¶ÈôêÂà∂ */
      background: linear-gradient(180deg, rgba(35, 40, 55, 0.98) 0%, rgba(25, 28, 40, 0.98) 100%);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
      z-index: 2001;
      opacity: 0;
      visibility: hidden;
      transform: translate(-50%, -50%) scale(0.9);
      transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .about-modal.show {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, -50%) scale(1);
    }

    .about-close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.05);
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      z-index: 10;
    }

    .about-close-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
    }

    /* Â§¥ÈÉ®Âå∫Âüü - Âõ∫ÂÆö */
    .about-header {
      padding: 32px 32px 24px;
      text-align: center;
      background: inherit;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.4s ease;
    }

    .about-header.collapsed {
      padding: 16px 32px;
    }

    .about-logo {
      width: 72px;
      height: 72px;
      margin: 0 auto 16px;
      background: linear-gradient(135deg, var(--theme-color) 0%, rgba(0, 212, 255, 0.6) 100%);
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      box-shadow: 0 8px 32px rgba(0, 212, 255, 0.25);
      transition: all 0.4s ease;
    }

    .about-header.collapsed .about-logo {
      width: 40px;
      height: 40px;
      font-size: 20px;
      border-radius: 10px;
      margin-bottom: 0;
    }

    .about-title-group {
      transition: all 0.4s ease;
      overflow: hidden;
    }

    .about-header.collapsed .about-title-group {
      height: 0;
      opacity: 0;
      margin: 0;
      padding: 0;
    }

    .about-app-name {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .about-version-badge {
      display: inline-block;
      padding: 4px 12px;
      background: rgba(var(--theme-color), 0.15);
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.15) 0%, rgba(0, 180, 220, 0.1) 100%);
      border: 1px solid rgba(0, 212, 255, 0.2);
      border-radius: 20px;
      font-size: 0.8rem;
      color: var(--theme-color);
      margin-top: 8px;
    }

    .about-author {
      margin-top: 12px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .about-author a {
      color: var(--theme-color);
      text-decoration: none;
      transition: opacity 0.2s;
    }

    .about-author a:hover {
      opacity: 0.8;
    }

    .about-stats {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.4s ease;
    }

    .about-header.collapsed .about-stats {
      display: none;
    }

    .about-stat {
      text-align: center;
    }

    .about-stat-value {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .about-stat-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    /* Êõ¥Êñ∞Êó•ÂøóÂå∫Âüü - ÂèØÊªöÂä® */
    .about-changelog {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;        /* üîß Êñ∞Â¢ûÔºöÈò≤Ê≠¢Ê∞¥Âπ≥ÊªöÂä® */
      padding: 20px 24px;
      min-height: 0;             /* üîß ÂÖ≥ÈîÆÊñ∞Â¢ûÔºöËøôË°åÂæàÈáçË¶ÅÔºÅËÆ©flexÂ≠êÂÖÉÁ¥†ÂèØ‰ª•Êî∂Áº© */
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,0.1) transparent;
    }

    .about-changelog::-webkit-scrollbar {
      width: 6px;
    }

    .about-changelog::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.1);
      border-radius: 3px;
    }

    .about-changelog::-webkit-scrollbar-thumb:hover {
      background: rgba(255,255,255,0.2);
    }

    .changelog-section {
      margin-bottom: 20px;
    }

    .changelog-section:last-child {
      margin-bottom: 0;
    }

    .changelog-date {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .changelog-date::before {
      content: '';
      width: 8px;
      height: 8px;
      background: var(--theme-color);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--theme-color);
    }

    .changelog-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-left: 16px;
      border-left: 2px solid rgba(255, 255, 255, 0.05);
    }

    .changelog-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 14px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 10px;
      transition: all 0.2s ease;
    }

    .changelog-item:hover {
      background: rgba(255, 255, 255, 0.04);
    }

    .changelog-tag {
      flex-shrink: 0;
      padding: 3px 8px;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .changelog-tag.new {
      background: linear-gradient(135deg, rgba(74, 222, 128, 0.2) 0%, rgba(34, 197, 94, 0.1) 100%);
      color: #4ade80;
      border: 1px solid rgba(74, 222, 128, 0.3);
    }

    .changelog-tag.fix {
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
      color: #fbbf24;
      border: 1px solid rgba(251, 191, 36, 0.3);
    }

    .changelog-tag.improve {
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%);
      color: #60a5fa;
      border: 1px solid rgba(96, 165, 250, 0.3);
    }

    .changelog-tag.remove {
      background: linear-gradient(135deg, rgba(248, 113, 113, 0.2) 0%, rgba(239, 68, 68, 0.1) 100%);
      color: #f87171;
      border: 1px solid rgba(248, 113, 113, 0.3);
    }

    .changelog-text {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* Â∫ïÈÉ®ÈìæÊé• */
    .about-footer {
      padding: 16px 24px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: center;
      gap: 20px;
    }

    .about-link {
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.8rem;
      transition: color 0.2s;
    }

    .about-link:hover {
      color: var(--theme-color);
    }

    .about-link svg {
      width: 16px;
      height: 16px;
    }

    /* ========== ÂæÆ‰ø°Áæ§ÂºπÁ™ó ========== */
    .wechat-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .wechat-modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .wechat-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.85);
      width: 320px;
      background: linear-gradient(145deg, #1a1d24 0%, #12141a 100%);
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 
        0 32px 64px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(255, 255, 255, 0.05) inset;
      z-index: 3001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      overflow: hidden;
    }

    .wechat-modal.show {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, -50%) scale(1);
    }

    .wechat-modal-header {
      padding: 24px 24px 16px;
      text-align: center;
      position: relative;
    }

    .wechat-modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.05);
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .wechat-modal-close:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
    }

    .wechat-icon {
      width: 56px;
      height: 56px;
      margin: 0 auto 12px;
      background: linear-gradient(135deg, #07c160 0%, #05a14b 100%);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 24px rgba(7, 193, 96, 0.3);
    }

    .wechat-icon svg {
      width: 32px;
      height: 32px;
      fill: white;
    }

    .wechat-modal-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .wechat-modal-subtitle {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .wechat-qr-container {
      padding: 20px 32px 24px;
      display: flex;
      justify-content: center;
    }

    .wechat-qr-wrapper {
      background: white;
      padding: 12px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .wechat-qr-wrapper img {
      width: 180px;
      height: 180px;
      display: block;
      border-radius: 8px;
    }

    .wechat-modal-footer {
      padding: 16px 24px 24px;
      text-align: center;
    }

    .wechat-tip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      background: rgba(7, 193, 96, 0.1);
      border: 1px solid rgba(7, 193, 96, 0.2);
      border-radius: 20px;
      font-size: 0.8rem;
      color: #07c160;
    }

    .wechat-tip svg {
      width: 14px;
      height: 14px;
    }










    /* ÈöêËóèÊñá‰ª∂ËæìÂÖ• */
    .hidden-input {
      display: none;
    }

    /* ‰∏ãÊãâÈÄâÊã©Âô® */
    .select-wrapper {
      position: relative;
    }

    .custom-select {
      padding: 8px 32px 8px 12px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.9rem;
      appearance: none;
      outline: none;
    }

    .select-wrapper::after {
      content: '‚ñº';
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.6rem;
      color: var(--text-muted);
      pointer-events: none;
    }

    /* ÊêúÁ¥¢ÂéÜÂè≤ */
    .search-history {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: var(--bg-darker);
      backdrop-filter: blur(20px);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 8px 0;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 999;
      max-height: 300px;
      overflow-y: auto;
    }

    .search-history.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .search-history-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
    }

    .search-history-item:hover {
      background: rgba(255,255,255,0.05);
    }

    .search-history-item svg {
      width: 16px;
      height: 16px;
      color: var(--text-muted);
    }

    .search-history-empty {
      padding: 20px;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .search-history-divider {
      height: 1px;
      background: var(--border);
      margin: 8px 0;
    }

    .search-history-clear {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-muted);
    }

    .search-history-clear:hover {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }

    .search-history-clear svg {
      width: 16px;
      height: 16px;
    }











    /* ÂìçÂ∫îÂºè */
    @media (max-width: 768px) {
      .clock {
        font-size: 3.5rem;
      }

      .workspace-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .wallpaper-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .dock-bar {
        bottom: 20px;
        padding: 8px 12px;
      }

      .dock-item {
        width: 38px;
        height: 38px;
      }
    }
  </style>
</head>
<body>
  <!-- ËÉåÊôØÂ±Ç -->
  <div class="background-layer" id="backgroundLayer"></div>
  <div class="vignette-layer" id="vignetteLayer"></div>

  <!-- Âõ∫ÂÆö‰æøÁ≠æ -->
  <div class="pinned-notes-wrapper collapsed" id="pinnedNotesWrapper">
    <div class="pinned-notes" id="pinnedNotes"></div>
    <button class="pinned-notes-toggle" id="pinnedNotesToggle" title="Êî∂Ëµ∑/Â±ïÂºÄ‰æøÁ≠æ">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>
  </div>






  <!-- Âè≥‰∏äËßíÊåâÈíÆ -->
  <div class="top-right-buttons">
    <button class="top-btn" id="userBtn" title="Áî®Êà∑">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
        <circle cx="12" cy="7" r="4"/>
      </svg>
    </button>
    <button class="top-btn" id="settingsBtn" title="ËÆæÁΩÆ">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
      </svg>
    </button>
  </div>

  <!-- Toast ÊèêÁ§∫ -->
  <div class="toast" id="toast"></div>

  <!-- ‰∏ªÂÆπÂô® -->
  <div class="main-container" id="mainContainer">
    <!-- Êó∂Èíü -->
    <section class="clock-section">
      <div class="clock" id="clock">00:00:00</div>
    </section>

    <!-- ÊêúÁ¥¢Ê°Ü -->
    <section class="search-section">
      <div class="search-container">
        <div class="search-box">
          <button class="search-engine-btn" id="engineBtn">
            <span class="search-engine-icon" id="currentEngineIcon">üêæ</span>
          </button>
          <input type="text" class="search-input" id="searchInput" placeholder="ÊêúÁ¥¢" autocomplete="off">
          <button class="search-submit-btn" id="searchSubmitBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </button>
        </div>

        <!-- ÊêúÁ¥¢ÂºïÊìé‰∏ãÊãâ -->
        <div class="search-engine-dropdown" id="engineDropdown">
          <div class="engine-option active" data-engine="baidu" data-icon='<img src="https://files.codelife.cc/itab/search/baidu.svg" width="20" height="20">' data-url="https://www.baidu.com/s?wd=">
            <span class="engine-option-icon"><img src="https://files.codelife.cc/itab/search/baidu.svg" width="20" height="20"></span>
            <span class="engine-option-name">ÁôæÂ∫¶</span>
            <span class="engine-option-shortcut">Alt+1</span>
          </div>
          <div class="engine-option" data-engine="bing" data-icon='<img src="https://files.codelife.cc/itab/search/bing.svg" width="20" height="20">' data-url="https://www.bing.com/search?q=">
            <span class="engine-option-icon"><img src="https://files.codelife.cc/itab/search/bing.svg" width="20" height="20"></span>
            <span class="engine-option-name">ÂøÖÂ∫î</span>
            <span class="engine-option-shortcut">Alt+2</span>
          </div>
          <div class="engine-option" data-engine="google" data-icon='<img src="https://files.codelife.cc/itab/search/google.svg" width="20" height="20">' data-url="https://www.google.com/search?q=">
            <span class="engine-option-icon"><img src="https://files.codelife.cc/itab/search/google.svg" width="20" height="20"></span>
            <span class="engine-option-name">Ë∞∑Ê≠å</span>
            <span class="engine-option-shortcut">Alt+3</span>
          </div>
          <div class="engine-option" data-engine="yandex" data-icon='<img src="https://files.codelife.cc/itab/search/yandex.svg" width="20" height="20">' data-url="https://yandex.com/search/?text=">
            <span class="engine-option-icon"><img src="https://files.codelife.cc/itab/search/yandex.svg" width="20" height="20"></span>
            <span class="engine-option-name">Yandex</span>
            <span class="engine-option-shortcut">Alt+4</span>
          </div>
          <!-- <div class="engine-dropdown-divider"></div>
          <div class="engine-settings-option" id="engineSettingsBtn">
            <span class="engine-option-icon">‚öôÔ∏è</span>
            <span class="engine-option-name">ÊêúÁ¥¢ÂºïÊìéÂÅèÂ•Ω</span>
          </div> -->
        </div>

        <!-- ÊêúÁ¥¢ÂéÜÂè≤ -->
        <div class="search-history" id="searchHistory"></div>
      </div>
    </section>

    <!-- ‰∏ÄË®Ä -->
    <section class="hitokoto-section" id="hitokotoSection">
      <p class="hitokoto" id="hitokoto" title="ÁÇπÂáªÂà∑Êñ∞ / Âè≥ÈîÆËÆæÁΩÆ">ÁîüÊ¥ªÊòéÊúóÔºå‰∏áÁâ©ÂèØÁà±</p>
    </section>
  </div>

  <!-- Â∫ïÈÉ®Âø´Êç∑Ê†è -->
  <div class="dock-bar" id="dockBar"></div>

  <!-- Âè≥ÈîÆËèúÂçïÔºàDockÊ†èÁî®Ôºâ -->
  <div class="context-menu" id="contextMenu">
    <div class="context-menu-item" data-action="add">
      <span>‚ûï</span>
      <span>Ê∑ªÂä†Â∫îÁî®</span>
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item danger" data-action="delete">
      <span>üóëÔ∏è</span>
      <span>Âà†Èô§Â∫îÁî®</span>
    </div>
  </div>

  <!-- workspaceÂ∫îÁî®Âè≥ÈîÆËèúÂçï -->
  <div class="context-menu" id="workspaceContextMenu">
    <div class="context-menu-item" data-action="edit">
      <span>‚úèÔ∏è</span>
      <span>ÁºñËæëÂ∫îÁî®</span>
    </div>
    <div class="context-menu-item" data-action="addToDock">
      <span>üìå</span>
      <span>Ê∑ªÂä†Âà∞‰æøÊç∑Ê†è</span>
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item danger" data-action="delete">
      <span>üóëÔ∏è</span>
      <span>Âà†Èô§Â∫îÁî®</span>
    </div>
  </div>

  <!-- Â∑•‰ΩúÂå∫ÂüüË¶ÜÁõñÂ±Ç -->
  <div class="workspace-overlay" id="workspaceOverlay">
    <div class="workspace-clock" id="workspaceClock">00:00:00</div>
    <div class="workspace-grid" id="workspaceGrid"></div>
  </div>

  <!-- ËÆæÁΩÆÈù¢Êùø -->
  <div class="settings-overlay" id="settingsOverlay"></div>
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-header">
      <h2 class="settings-title">Â∏∏ËßÑËÆæÁΩÆ</h2>
      <button class="settings-close" id="settingsClose">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div class="settings-content">
      <!-- ÊêúÁ¥¢ËÆæÁΩÆ -->
      <div class="settings-section">
        <h3 class="settings-section-title">ÊêúÁ¥¢</h3>
        <div class="settings-item">
          <div class="settings-item-label">ÊêúÁ¥¢ÂêéËá™Âä®Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü</div>
          <div class="toggle active" id="autoClearToggle"></div>
        </div>
        <div class="settings-item">
          <div class="settings-item-label">ËÆ∞ÂΩïÊêúÁ¥¢ÂéÜÂè≤</div>
          <div class="toggle active" id="searchHistoryToggle"></div>
        </div>
        <div class="settings-item">
          <div>
            <div class="settings-item-label">Tab ÈîÆË°å‰∏∫</div>
            <div class="settings-item-desc">Ëá™ÂÆö‰πâÊêúÁ¥¢Ê°ÜÂÜÖ Tab ÈîÆÂäüËÉΩ</div>
          </div>
          <div class="select-wrapper">
            <select class="custom-select" id="tabBehaviorSelect">
              <option value="engine">ÂàáÊç¢ÊêúÁ¥¢ÂºïÊìé</option>
              <option value="default">ÈªòËÆ§Ë°å‰∏∫</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Â§ñËßÇËÆæÁΩÆ -->
      <div class="settings-section">
        <h3 class="settings-section-title">Â§ñËßÇ</h3>
        <div class="settings-item">
          <div class="settings-item-label">ÊòæÁ§∫Â∫ïÈÉ®Âø´Êç∑Ê†è</div>
          <div class="toggle active" id="dockToggle"></div>
        </div>
        <div class="settings-item">
          <div class="settings-item-label">Êñ∞Ê†áÁ≠æÈ°µÊâìÂºÄÈìæÊé•</div>
          <div class="toggle active" id="newTabToggle"></div>
        </div>
        <div class="settings-item">
          <div class="settings-item-label">‰∏ªÈ¢òËâ≤</div>
          <div class="color-options">
            <div class="color-option green" data-color="#4ade80"></div>
            <div class="color-option cyan active" data-color="#00d4ff"></div>
            <div class="color-option purple" data-color="#a78bfa"></div>
            <div class="color-option pink" data-color="#f472b6"></div>
            <div class="color-option blue" data-color="#3b82f6"></div>
          </div>
        </div>
        <div class="settings-item">
          <div class="settings-item-label">Ê∑±Ëâ≤‰∏ªÈ¢ò</div>
          <div class="select-wrapper">
            <select class="custom-select" id="darkModeSelect">
              <option value="on">ÂºÄÂêØ</option>
              <option value="off">ÂÖ≥Èó≠</option>
              <option value="auto">Ë∑üÈöèÁ≥ªÁªü</option>
            </select>
          </div>
        </div>
        <div class="settings-item">
          <div class="settings-item-label">‰∏∫Â£ÅÁ∫∏Â∫îÁî®ÊöóËßíÊª§Èïú</div>
          <div class="toggle active" id="vignetteToggle"></div>
        </div>
      </div>

      <!-- Â£ÅÁ∫∏ËÆæÁΩÆ -->
      <div class="settings-section wallpaper-section">
        <h3 class="settings-section-title">Â£ÅÁ∫∏ÂÅèÂ•Ω</h3>
        <div class="wallpaper-upload-area">
          <div class="wallpaper-preview" id="wallpaperPreview">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <path d="m21 15-5-5L5 21"/>
            </svg>
          </div>
          <div class="wallpaper-upload-info">
            <h4>Â∞ÜÊÇ®ÂñúÁà±ÁöÑÂõæÁâáËÆæ‰∏∫Â£ÅÁ∫∏</h4>
            <p>ÊîØÊåÅÈÄâÊã©Êú¨Âú∞ÂõæÁâá</p>
            <div class="wallpaper-actions">
              <button class="wallpaper-action-btn" id="uploadWallpaperBtn">
                <span>üìÅ</span> Êú¨Âú∞ÂõæÁâá
              </button>
            </div>
          </div>
        </div>
        <h4 style="color: var(--text-secondary); margin-bottom: 12px;">ÈªòËÆ§Â£ÅÁ∫∏</h4>
        <div class="wallpaper-grid" id="wallpaperGrid"></div>
      </div>

      <!-- ‰∏ÄË®ÄËÆæÁΩÆ -->
      <div class="settings-section">
        <h3 class="settings-section-title">‰∏ÄË®ÄËÆæÁΩÆ</h3>
        <div class="settings-item" id="hitokotoSettingsBtn" style="cursor: pointer;">
          <div class="settings-item-label">ÁÆ°ÁêÜ‰∏ÄË®ÄÂè•Â≠ê</div>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m9 18 6-6-6-6"/>
          </svg>
        </div>
      </div>

      <!-- Êï∞ÊçÆÁÆ°ÁêÜ - Êñ∞Â¢ûÈÉ®ÂàÜ -->
      <div class="settings-section">
        <h3 class="settings-section-title">üì¶ Êï∞ÊçÆÁÆ°ÁêÜ</h3>
        <div class="settings-item" style="flex-direction: column; align-items: flex-start; gap: 12px;">
          <div class="settings-item-label">
            Â§á‰ªΩ‰∏éÊÅ¢Â§çÊÇ®ÁöÑÊï∞ÊçÆÔºà‰æøÁ≠æ„ÄÅÁΩëÁ´ô„ÄÅËÆæÁΩÆÁ≠âÔºâ
            <div class="settings-item-desc">Êï∞ÊçÆÂ≠òÂÇ®Âú®ÊÇ®ÁöÑÊµèËßàÂô®Êú¨Âú∞ÔºåÊ∏ÖÈô§ÊµèËßàÂô®Êï∞ÊçÆ‰ºö‰∏¢Â§±</div>
          </div>
          <div class="data-management-btns">
            <button class="data-btn" id="exportDataBtn">
              <span>üì§</span> ÂØºÂá∫Êï∞ÊçÆ
            </button>
            <button class="data-btn" id="importDataBtn">
              <span>üì•</span> ÂØºÂÖ•Êï∞ÊçÆ
            </button>
            <button class="data-btn danger" id="resetDataBtn">
              <span>üóëÔ∏è</span> ÈáçÁΩÆÊâÄÊúâÊï∞ÊçÆ
            </button>
          </div>
        </div>
        <div class="version-info" id="openAboutBtn" style="cursor: pointer; transition: color 0.2s;"> ÁâàÊú¨: v1.0.0 ¬∑ ÁÇπÂáªÊü•ÁúãÊõ¥Êñ∞Êó•Âøó ‚Üí </div>
      </div>
    </div>
  </div>

  <!-- ‰æøÁ≠æÂºπÁ™ó -->
  <div class="notes-modal" id="notesModal">
    <div class="notes-modal-header">
      <span class="notes-modal-title">‰æøÁ≠æ</span>
      <div class="notes-modal-actions">
        <button class="notes-modal-btn" id="pinNoteBtn" title="Âõ∫ÂÆöÂà∞‰∏ªÂ±èÂπï">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 17v5M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"/>
          </svg>
        </button>
        <button class="notes-modal-btn" id="expandNoteBtn" title="ÂÖ®Â±è">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
          </svg>
        </button>
        <button class="notes-modal-btn" id="deleteNoteBtn" title="Âà†Èô§">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
        </button>
        <button class="notes-modal-btn" id="closeNotesBtn" title="ÂÖ≥Èó≠">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="notes-modal-body">
      <div class="notes-sidebar">
        <div class="notes-sidebar-header">
          <button class="notes-add-btn" id="addNoteBtn">
            <span>+</span> Êñ∞‰æøÁ≠æ
          </button>
          <button class="notes-add-folder-btn" id="addFolderBtn">
            <span>üìÅ</span> Êñ∞Âª∫ÁõÆÂΩï
          </button>
        </div>
        <div class="notes-list" id="notesList"></div>
      </div>
      <div class="notes-editor" id="notesEditor">
        <div class="notes-editor-placeholder">Âú®Ê≠§ÈîÆÂÖ•‰ª•ÂàõÂª∫Êñ∞ÁöÑ‰æøÁ≠æ</div>
      </div>
    </div>
  </div>

  <!-- Ê∑ªÂä†Á´ôÁÇπÂºπÁ™ó -->
  <div class="add-site-modal" id="addSiteModal">
    <h3>Ê∑ªÂä†ÁΩëÁ´ô</h3>
    <div class="form-group">
      <label>ÁΩëÁ´ôÂêçÁß∞</label>
      <input type="text" id="siteNameInput" placeholder="‰æãÂ¶ÇÔºöGitHub">
    </div>
    <div class="form-group">
      <label>ÁΩëÁ´ôÂú∞ÂùÄ</label>
      <input type="text" id="siteUrlInput" placeholder="https://github.com">
    </div>
    <div class="form-group">
      <label>ÂõæÊ†á (emoji ÊàñÊñáÂ≠ó)</label>
      <input type="text" id="siteIconInput" placeholder="üêô" maxlength="2">
    </div>
    <div class="form-actions">
      <button class="btn btn-secondary" id="cancelAddSite">ÂèñÊ∂à</button>
      <button class="btn btn-primary" id="confirmAddSite">Ê∑ªÂä†</button>
    </div>
  </div>

  <!-- ÁºñËæëÁ´ôÁÇπÂºπÁ™ó -->
  <div class="add-site-modal" id="editSiteModal">
    <h3>ÁºñËæëÁΩëÁ´ô</h3>
    <div class="form-group">
      <label>ÁΩëÁ´ôÂêçÁß∞</label>
      <input type="text" id="editSiteNameInput" placeholder="‰æãÂ¶ÇÔºöGitHub">
    </div>
    <div class="form-group">
      <label>ÁΩëÁ´ôÂú∞ÂùÄ</label>
      <input type="text" id="editSiteUrlInput" placeholder="https://github.com">
    </div>
    <div class="form-group">
      <label>ÂõæÊ†á (emoji ÊàñÊñáÂ≠ó)</label>
      <input type="text" id="editSiteIconInput" placeholder="üêô" maxlength="2">
    </div>
    <div class="form-actions">
      <button class="btn btn-secondary" id="cancelEditSite">ÂèñÊ∂à</button>
      <button class="btn btn-primary" id="confirmEditSite">‰øùÂ≠ò</button>
    </div>
  </div>

  <!-- ‰∏ÄË®ÄËÆæÁΩÆÂºπÁ™ó -->
  <div class="hitokoto-modal" id="hitokotoModal">
    <h3>ÁÆ°ÁêÜ‰∏ÄË®ÄÂè•Â≠ê</h3>
    <div class="hitokoto-list" id="hitokotoList"></div>
    <div class="hitokoto-add-form">
      <input type="text" id="newHitokotoInput" placeholder="Ê∑ªÂä†Êñ∞ÁöÑ‰∏ÄË®Ä...">
      <button id="addHitokotoBtn">Ê∑ªÂä†</button>
    </div>
    <div class="form-actions" style="margin-top: 20px;">
      <button class="btn btn-secondary" id="closeHitokotoModal" style="flex: 0 0 auto;">ÂÖ≥Èó≠</button>
    </div>
  </div>

  <!-- Ê∑ªÂä†Êñá‰ª∂Â§πÂºπÁ™ó -->
  <div class="add-folder-modal" id="addFolderModal">
    <h3>Êñ∞Âª∫ÁõÆÂΩï</h3>
    <div class="form-group">
      <label>ÁõÆÂΩïÂêçÁß∞</label>
      <input type="text" id="folderNameInput" placeholder="‰æãÂ¶ÇÔºöÂ∑•‰Ωú">
    </div>
    <div class="form-actions">
      <button class="btn btn-secondary" id="cancelAddFolder">ÂèñÊ∂à</button>
      <button class="btn btn-primary" id="confirmAddFolder">ÂàõÂª∫</button>
    </div>
  </div>



<!-- ÂÖ≥‰∫éÊó•ÂøóÂºπÁ™ó -->
  <div class="about-modal-overlay" id="aboutModalOverlay"></div>
  <div class="about-modal" id="aboutModal">
    <button class="about-close-btn" id="aboutCloseBtn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 6L6 18M6 6l12 12"/>
      </svg>
    </button>
    
    <div class="about-header" id="aboutHeader">
      <div class="about-logo">‚ùÑÔ∏è</div>
      <div class="about-title-group">
        <div class="about-app-name">ÂÜ∞Â±øËµ∑ÂßãÈ°µ</div>
        <div class="about-version-badge" id="aboutVersionBadge">v1.0.0</div>
        <div class="about-author">
          Áî± <a href="#">ÈôàÂÜ∞Â∑ù</a> ÂÄæÂøÉÊâìÈÄ†
        </div>
        <div class="about-stats">
          <div class="about-stat">
            <div class="about-stat-value" id="aboutDaysOnline">0</div>
            <div class="about-stat-label">‰∏äÁ∫øÂ§©Êï∞</div>
          </div>
          <div class="about-stat">
            <div class="about-stat-value" id="aboutLastUpdate">--</div>
            <div class="about-stat-label">ÊúÄËøëÊõ¥Êñ∞</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="about-changelog" id="aboutChangelog">
      <!-- Êõ¥Êñ∞Êó•ÂøóÂ∞ÜÈÄöËøá JS Âä®ÊÄÅÁîüÊàê -->
    </div>
    
    <div class="about-footer">
      <a href="https://github.com/Glaciercowww" class="about-link">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
        GitHub
      </a>
      <a href="javascript:void(0)" class="about-link" id="openWechatModal">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 01.213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.328.328 0 00.186-.059l2.114-1.225a.867.867 0 01.428-.117c.074 0 .148.01.22.03.857.23 1.77.357 2.714.357.26 0 .517-.009.773-.028a5.853 5.853 0 01-.166-1.377c0-3.524 3.258-6.382 7.272-6.382.257 0 .511.013.762.038C16.33 4.811 12.834 2.188 8.691 2.188zm-2.92 4.652a.935.935 0 110 1.87.935.935 0 010-1.87zm5.458 0a.935.935 0 110 1.87.935.935 0 010-1.87z"/></svg>
        ÂèçÈ¶àÁæ§
      </a>
    </div>
  </div>


  <!-- ÂæÆ‰ø°Áæ§ÂºπÁ™ó -->
  <div class="wechat-modal-overlay" id="wechatModalOverlay"></div>
  <div class="wechat-modal" id="wechatModal">
    <div class="wechat-modal-header">
      <button class="wechat-modal-close" id="wechatModalClose">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
      <div class="wechat-icon">
        <svg viewBox="0 0 24 24"><path d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 01.213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.328.328 0 00.186-.059l2.114-1.225a.867.867 0 01.428-.117c.074 0 .148.01.22.03.857.23 1.77.357 2.714.357.26 0 .517-.009.773-.028a5.853 5.853 0 01-.166-1.377c0-3.524 3.258-6.382 7.272-6.382.257 0 .511.013.762.038C16.33 4.811 12.834 2.188 8.691 2.188zm-2.92 4.652a.935.935 0 110 1.87.935.935 0 010-1.87zm5.458 0a.935.935 0 110 1.87.935.935 0 010-1.87zM17.4 9.932c-3.466 0-6.276 2.484-6.276 5.547 0 3.063 2.81 5.547 6.276 5.547.675 0 1.325-.092 1.938-.264a.614.614 0 01.156-.02.61.61 0 01.303.083l1.497.87a.232.232 0 00.131.041.205.205 0 00.205-.205c0-.05-.02-.1-.034-.148l-.277-1.048a.418.418 0 01.151-.472c1.296-.956 2.131-2.37 2.131-3.934 0-3.063-2.81-5.547-6.276-5.547zm-2.344 3.148a.748.748 0 11-.002 1.496.748.748 0 01.002-1.496zm4.688 0a.748.748 0 11-.002 1.496.748.748 0 01.002-1.496z"/></svg>
      </div>
      <div class="wechat-modal-title">Âä†ÂÖ•Á≤â‰∏ùÁæ§</div>
      <div class="wechat-modal-subtitle">Êâ´Á†ÅÂä†ÂÖ•Ôºå‰∫§ÊµÅÂèçÈ¶à</div>
    </div>
    <div class="wechat-qr-container">
      <div class="wechat-qr-wrapper">
        <img src="assets/images/wechat-qr.png" alt="ÂæÆ‰ø°Áæ§‰∫åÁª¥Á†Å" id="wechatQrImage">
      </div>
    </div>
    <div class="wechat-modal-footer">
      <div class="wechat-tip">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        ÈïøÊåâÊàñÊà™ÂõæÊâ´Á†ÅÂä†ÂÖ•
      </div>
    </div>
  </div>





  <!-- ÈöêËóèÁöÑÊñá‰ª∂ËæìÂÖ• -->
  <input type="file" id="wallpaperFileInput" class="hidden-input" accept="image/*" multiple>
  <input type="file" id="importFileInput" class="hidden-input" accept=".json">

  <script>
    // ==================== Â∫îÁî®ÁâàÊú¨ ====================
    const APP_VERSION = '1.0.0';
    const DATA_VERSION = 1; // Êï∞ÊçÆÁªìÊûÑÁâàÊú¨ÔºåÁî®‰∫éÊú™Êù•ËøÅÁßª


        // ==================== Êõ¥Êñ∞Êó•ÂøóÊï∞ÊçÆ ====================
    const CHANGELOG_DATA = [
      {
        date: '2025-11-30',
        items: [
          { type: 'new', text: 'ÂÖ®Êñ∞ÁöÑÂÜ∞Â±øËµ∑ÂßãÈ°µÊ≠£ÂºèÂèëÂ∏É' },
          { type: 'new', text: 'ÊîØÊåÅËá™ÂÆö‰πâÂ£ÅÁ∫∏' },
          { type: 'new', text: '‰æøÁ≠æÂäüËÉΩÊîØÊåÅ ‰ªªÂä°ÂàóË°®' },
          { type: 'new', text: 'Â∫ïÊêúÁ¥¢ÂêéËá™Âä®Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü' },
          { type: 'new', text: 'ËÆ∞ÂΩïÊêúÁ¥¢ÂéÜÂè≤' },
          { type: 'new', text: 'Â∫ïÈÉ®Âø´Êç∑Ê†èÊîØÊåÅÊãñÊãΩÊéíÂ∫è' },
          { type: 'fix', text: 'ÂäüËÉΩÊµãËØï' },
        ]
      },
      {
        date: '2025-11-29',
        items: [
          { type: 'improve', text: '‰ºòÂåñÊêúÁ¥¢Ê°Ü‰∫§‰∫í‰ΩìÈ™å' },
          { type: 'fix', text: '‰øÆÂ§çÂ£ÅÁ∫∏Âä†ËΩΩÂ§±Ë¥•ÁöÑÈóÆÈ¢ò' },
          { type: 'new', text: 'Êñ∞Â¢û‰∏ÄË®ÄÂè•Â≠êËá™ÂÆö‰πâÂäüËÉΩ' },
        ]
      },
      {
        date: '2025-11-26',
        items: [
          { type: 'new', text: 'È°πÁõÆÂàùÂßãÂåñÔºåÂºÄÂßãÂºÄÂèë' },
        ]
      }
    ];

    // È°πÁõÆ‰∏äÁ∫øÊó•ÊúüÔºàÁî®‰∫éËÆ°ÁÆó‰∏äÁ∫øÂ§©Êï∞Ôºâ
    const PROJECT_START_DATE = new Date('2025-11-26');

    // ==================== ÂÖ≥‰∫éÂºπÁ™óÂáΩÊï∞ ====================
    function openAboutModal() {
      // Êõ¥Êñ∞ÁâàÊú¨Âè∑
      document.getElementById('aboutVersionBadge').textContent = `v${APP_VERSION}`;
      
      // ËÆ°ÁÆó‰∏äÁ∫øÂ§©Êï∞
      const today = new Date();
      const daysOnline = Math.floor((today - PROJECT_START_DATE) / (1000 * 60 * 60 * 24));
      document.getElementById('aboutDaysOnline').textContent = daysOnline;
      
      // ÊúÄËøëÊõ¥Êñ∞Êó•Êúü
      if (CHANGELOG_DATA.length > 0) {
        document.getElementById('aboutLastUpdate').textContent = CHANGELOG_DATA[0].date;
      }
      
      // Ê∏≤ÊüìÊõ¥Êñ∞Êó•Âøó
      renderChangelog();
      
      // ÈáçÁΩÆÂ§¥ÈÉ®Áä∂ÊÄÅ
      document.getElementById('aboutHeader').classList.remove('collapsed');
      document.getElementById('aboutChangelog').scrollTop = 0;
      
      // ÊòæÁ§∫ÂºπÁ™ó
      document.getElementById('aboutModalOverlay').classList.add('show');
      document.getElementById('aboutModal').classList.add('show');
    }

    function closeAboutModal() {
      document.getElementById('aboutModalOverlay').classList.remove('show');
      document.getElementById('aboutModal').classList.remove('show');
    }

    function renderChangelog() {
      const container = document.getElementById('aboutChangelog');
      const typeLabels = {
        'new': 'Êñ∞Â¢û',
        'fix': '‰øÆÂ§ç',
        'improve': '‰ºòÂåñ',
        'remove': 'ÁßªÈô§'
      };
      
      container.innerHTML = CHANGELOG_DATA.map(section => `
        <div class="changelog-section">
          <div class="changelog-date">${section.date}</div>
          <div class="changelog-items">
            ${section.items.map(item => `
              <div class="changelog-item">
                <span class="changelog-tag ${item.type}">${typeLabels[item.type] || item.type}</span>
                <span class="changelog-text">${item.text}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    // ÊªöÂä®Êó∂ÈöêËóèÂ§¥ÈÉ®‰ø°ÊÅØÁöÑÂä®Áîª
    function setupAboutScrollEffect() {
      const changelog = document.getElementById('aboutChangelog');
      const header = document.getElementById('aboutHeader');
      
      changelog.addEventListener('scroll', () => {
        if (changelog.scrollTop > 30) {
          header.classList.add('collapsed');
        } else {
          header.classList.remove('collapsed');
        }
      });
    }




    // ==================== Êï∞ÊçÆÂ≠òÂÇ® ====================
    const defaultWallpapers = [
      'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920',
      'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1920',
      'https://images.unsplash.com/photo-1764100039100-9c62823c0f5c?q=80&w=1716&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
      'https://images.unsplash.com/photo-1764083572103-d860aa226bf3?q=80&w=1931&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
      'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=1920',
      'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1920',
      'https://images.unsplash.com/photo-1433086966358-54859d0ed716?w=1920',
      'https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=1920',
      './assets/wallpaper/pic1.jpg',
      './assets/wallpaper/pic2.jpg',
    ];

    const defaultHitokoto = [
      'ÂâçÈÄîÊòØÂÖâÊòéÁöÑÔºåÈÅìË∑ØÊòØÊõ≤Êäò',
      '‰∫∫ÁîüÂ§©Âú∞‰πãÈó¥ÔºåËã•ÁôΩÈ©πËøáÈöôÔºåÂøΩÁÑ∂ËÄåÂ∑≤',
      '‰∏çË¶ÅË∞©È™Ç‰ª•ÂâçÁöÑËá™Â∑±Ôºå‰ªñÂΩìÂàù‰∏Ä‰∏™‰∫∫Á´ôÂú®ÈõæÈáå‰πüÂæàËø∑Ëå´',
      'ÂùöÂÜ∞ËøòÁõñÁùÄÂåóÊµ∑ÁöÑÊó∂ÂÄôÔºåÊàëÁúãËßÅ‰∫ÜÊÄíÊîæÁöÑÊ¢ÖËä±',
      'ÈÅá‰∫ã‰∏çÊÄíÔºåÂü∫Êú¨ÂêÉÁ¥†ÔºåÂ§öÂ§öÊï£Ê≠•ÔºåÂä≥ÈÄ∏ÈÄÇÂ∫¶',
      '‰ΩïÂøÖÁî®ÂøÖÁÑ∂ÁöÑÊ≠ª‰∫°ÔºåÂõ∞‰ΩèË±ÅÁÑ∂ÁöÑ‰∏ÄÁîü',
      'Áà±ÊòØ‰∫∫Á±ªÊúÄÂ∞èÂâÇÈáèÁöÑÂÖ±‰∫ß‰∏ª‰πâ'
      
    ];

    const defaultSites = [
      { name: '‰æøÁ≠æ', url: '#notes', icon: 'üìù', color: '#f59e0b', isSpecial: true },
      { name: 'Ê∑±Ëâ≤‰∏ªÈ¢ò', url: '#theme', icon: 'üåô', color: '#1e1b4b', isSpecial: true },
      { name: 'ÁøªËØë', url: 'https://fanyi.youdao.com/#/TextTranslate', icon: '<img src="./assets/ico/1.svg" width="24" height="24">', color: '#06b6d4' },
      { name: 'Ë±ÜÂåÖ', url: 'https://www.doubao.com/chat/', icon: '<img src="./assets/ico/doubao2.png" width="36" height="36">',  color: 'linear-gradient(135deg, #10b981, #059669)' },
      // { name: 'ÂõæÁâá', url: 'https://unsplash.com', icon: 'üñºÔ∏è', color: '#f43f5e' },
      
      // { name: 'Á©∫ÊäïÂø´‰º†', url: 'https://airportal.cn', icon: '‚òÅÔ∏è', color: '#3b82f6' },
      { name: 'QQ ÈÇÆÁÆ±', url: 'https://mail.qq.com', icon: '<img src="./assets/ico/qqemail.svg" width="48" height="48">', color: 'transparent' },
      { name: 'ÁΩëÊòì‰∫ëÈü≥‰πê', url: 'https://music.163.com', icon: '<img src="./assets/ico/wangyiyun.svg" width="48" height="48">', color:'transparent' },
      { name: 'bilibili', url: 'https://www.bilibili.com', icon: '<img src="./assets/ico/bilibili.svg" width="48" height="48">', color: 'transparent' },
      { name: 'ÊäñÈü≥', url: 'https://www.douyin.com', icon: '<img src="./assets/ico/douyin.svg" width="48" height="48">', color: 'transparent' },  
      
    ];

    const defaultDockItems = [
      { name: 'Â∫îÁî®', icon: 'apps', color: 'linear-gradient(135deg, #6366f1, #8b5cf6)', action: 'apps' },
      { name: '‰æøÁ≠æ', icon: 'üìù', color: 'linear-gradient(135deg, #f59e0b, #d97706)', action: 'notes' },
      { name: 'ÊúâÈÅìÁøªËØë', url: 'https://fanyi.youdao.com/#/TextTranslate', icon: '<img src="./assets/ico/1.svg" width="24" height="24">', color: 'linear-gradient(135deg, #06b6d4, #0891b2)' },
      { name: 'Ë±ÜÂåÖ', url: 'https://www.doubao.com/chat/', icon: '<img src="./assets/ico/doubao2.png" width="36" height="36">', color: 'linear-gradient(135deg, #10b981, #059669)' },
      { name: 'Ê∑±Ëâ≤‰∏ªÈ¢ò', icon: 'üåô', color: 'linear-gradient(135deg, #1e1b4b, #312e81)', action: 'theme' },
    ];

    // Âä†ËΩΩÂ≠òÂÇ®ÁöÑÊï∞ÊçÆ
    function loadData(key, defaultValue) {
      try {
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : defaultValue;
      } catch {
        return defaultValue;
      }
    }

    function saveData(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }

    // ÊòæÁ§∫ Toast ÊèêÁ§∫
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // ==================== Êï∞ÊçÆÂØºÂÖ•ÂØºÂá∫ ====================
    function exportData() {
      const exportData = {
        version: DATA_VERSION,
        appVersion: APP_VERSION,
        exportDate: new Date().toISOString(),
        data: {
          settings: loadData('settings', {}),
          sites: loadData('sites', defaultSites),
          dockItems: loadData('dockItems', defaultDockItems),
          hitokotoList: loadData('hitokotoList', defaultHitokoto),
          notes: loadData('notes', []),
          folders: loadData('folders', []),
          pinnedNoteIds: loadData('pinnedNoteIds', []),
          currentEngine: loadData('currentEngine', 'baidu'),
          searchHistoryData: loadData('searchHistoryData', [])
        }
      };

      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `startpage-backup-${new Date().toISOString().slice(0,10)}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showToast('Êï∞ÊçÆÂØºÂá∫ÊàêÂäüÔºÅ');
    }

    function importData(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const importedData = JSON.parse(e.target.result);
          
          // È™åËØÅÊï∞ÊçÆÊ†ºÂºè
          if (!importedData.data) {
            throw new Error('Êó†ÊïàÁöÑÂ§á‰ªΩÊñá‰ª∂Ê†ºÂºè');
          }

          // ÊÅ¢Â§çÊï∞ÊçÆ
          const { data } = importedData;
          if (data.settings) saveData('settings', data.settings);
          if (data.sites) saveData('sites', data.sites);
          if (data.dockItems) saveData('dockItems', data.dockItems);
          if (data.hitokotoList) saveData('hitokotoList', data.hitokotoList);
          if (data.notes) saveData('notes', data.notes);
          if (data.folders) saveData('folders', data.folders);
          if (data.pinnedNoteIds) saveData('pinnedNoteIds', data.pinnedNoteIds);
          if (data.currentEngine) saveData('currentEngine', data.currentEngine);
          if (data.searchHistoryData) saveData('searchHistoryData', data.searchHistoryData);

          showToast('Êï∞ÊçÆÂØºÂÖ•ÊàêÂäüÔºÅÈ°µÈù¢Â∞ÜÂà∑Êñ∞...');
          setTimeout(() => {
            location.reload();
          }, 1500);
        } catch (error) {
          showToast('ÂØºÂÖ•Â§±Ë¥•: ' + error.message, 'error');
        }
      };
      reader.readAsText(file);
    }

    function resetAllData() {
      if (confirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâÊï∞ÊçÆÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ\n\nÂª∫ËÆÆÂÖàÂØºÂá∫Â§á‰ªΩ„ÄÇ')) {
        if (confirm('ÂÜçÊ¨°Á°ÆËÆ§ÔºöÁúüÁöÑË¶ÅÂà†Èô§ÊâÄÊúâÊï∞ÊçÆÂêóÔºü')) {
          localStorage.clear();
          showToast('Êï∞ÊçÆÂ∑≤ÈáçÁΩÆÔºÅÈ°µÈù¢Â∞ÜÂà∑Êñ∞...');
          setTimeout(() => {
            location.reload();
          }, 1500);
        }
      }
    }

    // Áä∂ÊÄÅ
    let settings = loadData('settings', {
      autoClear: true,
      searchHistory: true,
      tabBehavior: 'engine',
      showDock: true,
      newTab: true,
      themeColor: '#00d4ff',
      darkMode: 'on',
      vignette: true,
      currentWallpaper: defaultWallpapers[0]
    });

    let sites = loadData('sites', defaultSites);
    let dockItems = loadData('dockItems', defaultDockItems);
    let hitokotoList = loadData('hitokotoList', defaultHitokoto);
    let searchHistoryData = loadData('searchHistoryData', []);
    let notes = loadData('notes', []);
    let folders = loadData('folders', [{ id: 'default', name: 'ÈªòËÆ§', collapsed: false }]);
    let pinnedNoteIds = loadData('pinnedNoteIds', []);
    let currentEngine = loadData('currentEngine', 'baidu');
    let currentNoteId = null;
    let isNotesFullscreen = false;
    let contextMenuTarget = null;
    let workspaceContextMenuTarget = null;  // workspaceÂ∫îÁî®Âè≥ÈîÆËèúÂçïÁõÆÊ†á
    let editingSiteIndex = -1;  // Ê≠£Âú®ÁºñËæëÁöÑÁ´ôÁÇπÁ¥¢Âºï
    let draggedItem = null;

    // ==================== ÂàùÂßãÂåñ ====================
    function init() {
      applySettings();
      updateClock();
      setInterval(updateClock, 1000);
      renderWallpaperGrid();
      renderWorkspaceGrid();
      renderDockBar();
      initDockDrag();
      renderHitokoto();
      renderNotes();
      renderPinnedNotes();
      bindEvents();
      updateEngineUI();
    }

    // ==================== Êó∂Èíü ====================
    function updateClock() {
      const now = new Date();
      const time = now.toTimeString().slice(0, 8);
      document.getElementById('clock').textContent = time;
      const workspaceClock = document.getElementById('workspaceClock');
      if (workspaceClock) workspaceClock.textContent = time;
    }





    // Â∫îÁî®Ê∑±Ëâ≤/ÊµÖËâ≤Ê®°Âºè
    function applyDarkMode() {
      if (settings.darkMode === 'off') {
        document.body.classList.add('light-mode');
      } else if (settings.darkMode === 'on') {
        document.body.classList.remove('light-mode');
      } else if (settings.darkMode === 'auto') {
        // Ë∑üÈöèÁ≥ªÁªü
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (prefersDark) {
          document.body.classList.remove('light-mode');
        } else {
          document.body.classList.add('light-mode');
        }
      }
    }








    // ==================== ËÆæÁΩÆÂ∫îÁî® ====================
    function applySettings() {
      document.documentElement.style.setProperty('--theme-color', settings.themeColor);
      applyDarkMode();  // üîß Ê∑ªÂä†Á•ûËâ≤Ê®°Âºè
      const bgLayer = document.getElementById('backgroundLayer');
      if (settings.currentWallpaper) {
        bgLayer.style.backgroundImage = `url(${settings.currentWallpaper})`;
      }
      
      document.getElementById('vignetteLayer').style.display = settings.vignette ? 'block' : 'none';
      document.getElementById('dockBar').style.display = settings.showDock ? 'flex' : 'none';
      
      updateSettingsUI();
    }

    function updateSettingsUI() {
      document.getElementById('autoClearToggle').classList.toggle('active', settings.autoClear);
      document.getElementById('searchHistoryToggle').classList.toggle('active', settings.searchHistory);
      document.getElementById('dockToggle').classList.toggle('active', settings.showDock);
      document.getElementById('newTabToggle').classList.toggle('active', settings.newTab);
      document.getElementById('vignetteToggle').classList.toggle('active', settings.vignette);
      
      document.getElementById('tabBehaviorSelect').value = settings.tabBehavior;
      document.getElementById('darkModeSelect').value = settings.darkMode;
      
      document.querySelectorAll('.color-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.color === settings.themeColor);
      });
    }

    // ==================== ÊêúÁ¥¢ÂäüËÉΩ ====================
    const searchEngines = {
      baidu: { icon: '<img src="https://files.codelife.cc/itab/search/baidu.svg" width="20" height="20">', url: 'https://www.baidu.com/s?wd=' },
      bing: { icon: '<img src="https://files.codelife.cc/itab/search/bing.svg" width="20" height="20">', url: 'https://www.bing.com/search?q=' },
      google: { icon: '<img src="https://files.codelife.cc/itab/search/google.svg" width="20" height="20">', url: 'https://www.google.com/search?q=' },
      yandex: { icon: '<img src="https://files.codelife.cc/itab/search/yandex.svg" width="20" height="20">', url: 'https://yandex.com/search/?text=' }
    };

    function updateEngineUI() {
      const engine = searchEngines[currentEngine];
      document.getElementById('currentEngineIcon').innerHTML = engine.icon;  // ‚Üê ËøôÈáåÊîπÊàê innerHTML
      document.querySelectorAll('.engine-option[data-engine]').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.engine === currentEngine);
      });
    }

    function setEngine(engineName) {
      currentEngine = engineName;
      saveData('currentEngine', currentEngine);
      updateEngineUI();
      document.getElementById('engineDropdown').classList.remove('show');
    }

    function doSearch() {
      const query = document.getElementById('searchInput').value.trim();
      if (!query) return;
      
      if (settings.searchHistory) {
        searchHistoryData = [query, ...searchHistoryData.filter(h => h !== query)].slice(0, 20);
        saveData('searchHistoryData', searchHistoryData);
      }
      
      const url = searchEngines[currentEngine].url + encodeURIComponent(query);
      if (settings.newTab) {
        window.open(url, '_blank');
      } else {
        window.location.href = url;
      }
      
      if (settings.autoClear) {
        document.getElementById('searchInput').value = '';
      }
    }

    // function showSearchHistory() {
    //   if (!settings.searchHistory || searchHistoryData.length === 0) return;
      
    //   const container = document.getElementById('searchHistory');
    //   container.innerHTML = searchHistoryData.map(item => `
    //     <div class="search-history-item" data-query="${item}">
    //       <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    //         <circle cx="12" cy="12" r="10"/>
    //         <polyline points="12 6 12 12 16 14"/>
    //       </svg>
    //       <span>${item}</span>
    //     </div>
    //   `).join('');
    //   container.classList.add('show');
    // }

    function showSearchHistory() {
      if (!settings.searchHistory) return;
      
      const container = document.getElementById('searchHistory');
      
      if (searchHistoryData.length === 0) {
        container.innerHTML = '<div class="search-history-empty">ÊöÇÊó†ÊêúÁ¥¢ÂéÜÂè≤</div>';
        container.classList.add('show');
        return;
      }
      
      container.innerHTML = searchHistoryData.map(item => `
        <div class="search-history-item" data-query="${item}">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          <span>${item}</span>
        </div>
      `).join('') + `
        <div class="search-history-divider"></div>
        <div class="search-history-clear" id="clearHistoryBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          <span>Ê∏ÖÈô§ÂéÜÂè≤ËÆ∞ÂΩï</span>
        </div>
      `;
      container.classList.add('show');
    }





    // ==================== ‰∏ÄË®Ä ====================
    function renderHitokoto() {
      const text = hitokotoList[Math.floor(Math.random() * hitokotoList.length)];
      document.getElementById('hitokoto').textContent = text;
    }

    function renderHitokotoList() {
      const container = document.getElementById('hitokotoList');
      container.innerHTML = hitokotoList.map((text, index) => `
        <div class="hitokoto-item">
          <span class="hitokoto-item-text">${text}</span>
          <button class="hitokoto-item-delete" data-index="${index}">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        </div>
      `).join('');
    }

    // ==================== Â£ÅÁ∫∏ ====================
    function renderWallpaperGrid() {
      const grid = document.getElementById('wallpaperGrid');
      grid.innerHTML = defaultWallpapers.map((url, index) => `
        <div class="wallpaper-item ${settings.currentWallpaper === url ? 'active' : ''}" data-url="${url}">
          <img src="${url.includes('unsplash') ? url + '&w=300' : url}" alt="Â£ÅÁ∫∏ ${index + 1}">
          <div class="check-icon">‚úì</div>
        </div>
      `).join('');
    }

    function setWallpaper(url) {
      settings.currentWallpaper = url;
      saveData('settings', settings);
      document.getElementById('backgroundLayer').style.backgroundImage = `url(${url})`;
      renderWallpaperGrid();
    }

    // ==================== Dock Ê†è ====================
    function renderDockBar() {
      const dock = document.getElementById('dockBar');
      dock.innerHTML = dockItems.map((item, index) => {
        if (item.action === 'apps') {
          return `
            <div class="dock-item" data-title="${item.name}" data-action="apps" data-index="${index}" style="background: ${item.color};">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="7" height="7" rx="1"/>
              </svg>
            </div>
          `;
        } else if (item.action === 'notes') {
          return `<div class="dock-item" data-title="${item.name}" data-action="notes" data-index="${index}" style="background: ${item.color};">${item.icon}</div>`;
        } else if (item.action === 'theme') {
          return `<div class="dock-item" data-title="${item.name}" data-action="theme" data-index="${index}" style="background: ${item.color};">${item.icon}</div>`;
        } else {
          return `<a class="dock-item" href="${item.url}" target="_blank" data-title="${item.name}" data-index="${index}" style="background: ${item.color};">${item.icon}</a>`;
        }
      }).join('');
    }




  
// ==================== Dock ÊãñÊãΩÊéíÂ∫èÂäüËÉΩ ====================
    let dragState = {
      isDragging: false,
      draggedIndex: -1,
      shakeTimer: null,
      hasShaken: false
    };

    function initDockDrag() {
      const dock = document.getElementById('dockBar');
      
      dock.addEventListener('mousedown', handleDragStart);
      dock.addEventListener('touchstart', handleDragStart, { passive: false });
      document.addEventListener('mousemove', handleDragMove);
      document.addEventListener('touchmove', handleDragMove, { passive: false });
      document.addEventListener('mouseup', handleDragEnd);
      document.addEventListener('touchend', handleDragEnd);
    }

    function handleDragStart(e) {
      const item = e.target.closest('.dock-item');
      if (!item) return;
      
      e.preventDefault();
      
      dragState.isDragging = true;
      dragState.draggedIndex = parseInt(item.dataset.index);
      dragState.hasShaken = false;
      
      item.classList.add('dragging');
    }

    function handleDragMove(e) {
      if (!dragState.isDragging) return;
      
      e.preventDefault();
      const touch = e.touches ? e.touches[0] : e;
      const dock = document.getElementById('dockBar');
      const items = [...dock.querySelectorAll('.dock-item')];
      
      items.forEach(item => {
        const index = parseInt(item.dataset.index);
        if (index === dragState.draggedIndex) return;
        
        const rect = item.getBoundingClientRect();
        const isOver = touch.clientX > rect.left && touch.clientX < rect.right;
        
        if (isOver) {
          item.classList.add('drag-over');
          
          // Âè™ÊäñÂä®1ÁßíÔºå‰πãÂêé‰∏çÂÜçÊäñÂä®
          if (!dragState.hasShaken && !item.classList.contains('shake')) {
            item.classList.add('shake');
            
            dragState.shakeTimer = setTimeout(() => {
              item.classList.remove('shake');
              dragState.hasShaken = true;
            }, 300);
          }
        } else {
          item.classList.remove('drag-over', 'shake');
        }
      });
    }

    function handleDragEnd(e) {
      if (!dragState.isDragging) return;
      
      const touch = e.changedTouches ? e.changedTouches[0] : e;
      const dock = document.getElementById('dockBar');
      const items = [...dock.querySelectorAll('.dock-item')];
      
      // Ê∏ÖÈô§ÊâÄÊúâÊ†∑Âºè
      items.forEach(item => {
        item.classList.remove('dragging', 'drag-over', 'shake');
      });
      
      // Êü•ÊâæÁõÆÊ†á‰ΩçÁΩÆÂπ∂‰∫§Êç¢
      let targetIndex = -1;
      items.forEach(item => {
        const rect = item.getBoundingClientRect();
        if (touch.clientX > rect.left && touch.clientX < rect.right) {
          targetIndex = parseInt(item.dataset.index);
        }
      });
      
      if (targetIndex !== -1 && targetIndex !== dragState.draggedIndex) {
        const temp = dockItems[dragState.draggedIndex];
        dockItems[dragState.draggedIndex] = dockItems[targetIndex];
        dockItems[targetIndex] = temp;
        saveData('dockItems', dockItems);
        renderDockBar();
      }
      
      // Ê∏ÖÈô§ÂÆöÊó∂Âô®
      if (dragState.shakeTimer) {
        clearTimeout(dragState.shakeTimer);
      }
      
      dragState.isDragging = false;
      dragState.draggedIndex = -1;
      dragState.shakeTimer = null;
      dragState.hasShaken = false;
    }









    // ==================== Â∑•‰ΩúÂå∫ ====================
    function renderWorkspaceGrid() {
      const grid = document.getElementById('workspaceGrid');
      grid.innerHTML = sites.map((site, index) => {
        const deleteBtn = !site.isSpecial ? `<button class="workspace-item-delete" data-index="${index}">√ó</button>` : '';
        
        if (site.url === '#notes') {
          return `
            <div class="workspace-item" data-action="notes" data-index="${index}" draggable="true">
              ${deleteBtn}
              <div class="workspace-item-icon" style="background: ${site.color}">${site.icon}</div>
              <span class="workspace-item-name">${site.name}</span>
            </div>
          `;
        }
        if (site.url === '#theme') {
          return `
            <div class="workspace-item" data-action="theme" data-index="${index}" draggable="true">
              ${deleteBtn}
              <div class="workspace-item-icon" style="background: ${site.color}">${site.icon}</div>
              <span class="workspace-item-name">${site.name}</span>
            </div>
          `;
        }
        return `
          <a class="workspace-item" href="${site.url}" target="${settings.newTab ? '_blank' : '_self'}" data-index="${index}" draggable="true">
            ${deleteBtn}
            <div class="workspace-item-icon" style="background: ${site.color}">${site.icon}</div>
            <span class="workspace-item-name">${site.name}</span>
          </a>
        `;
      }).join('') + `
        <div class="workspace-item workspace-add-item" id="addSiteBtn">
          <span class="workspace-add-icon">+</span>
        </div>
      `;

      bindWorkspaceDragEvents();
    }

    function bindWorkspaceDragEvents() {
      const items = document.querySelectorAll('.workspace-item[draggable="true"]');
      
      items.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          draggedItem = item;
          item.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });

        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
          document.querySelectorAll('.workspace-item').forEach(i => i.classList.remove('drag-over'));
          draggedItem = null;
        });

        item.addEventListener('dragover', (e) => {
          e.preventDefault();
          if (draggedItem && draggedItem !== item && !item.classList.contains('workspace-add-item')) {
            item.classList.add('drag-over');
          }
        });

        item.addEventListener('dragleave', () => {
          item.classList.remove('drag-over');
        });

        item.addEventListener('drop', (e) => {
          e.preventDefault();
          item.classList.remove('drag-over');
          
          if (draggedItem && draggedItem !== item) {
            const fromIndex = parseInt(draggedItem.dataset.index);
            const toIndex = parseInt(item.dataset.index);
            
            if (!isNaN(fromIndex) && !isNaN(toIndex)) {
              const movedItem = sites.splice(fromIndex, 1)[0];
              sites.splice(toIndex, 0, movedItem);
              saveData('sites', sites);
              renderWorkspaceGrid();
            }
          }
        });
      });
    }

    // ==================== ‰æøÁ≠æ ====================
    function renderNotes() {
      const list = document.getElementById('notesList');
      
      let html = '';
      
      folders.forEach(folder => {
        const folderNotes = notes.filter(n => (n.folderId || 'default') === folder.id);
        
        html += `
          <div class="notes-folder" data-folder-id="${folder.id}">
            <div class="notes-folder-header ${folder.collapsed ? 'collapsed' : ''}" data-folder-id="${folder.id}">
              <span class="folder-arrow">‚ñº</span>
              <span>üìÅ ${folder.name}</span>
              <div style="margin-left:auto;display:flex;gap:4px;">
                <button class="add-note-to-folder-btn" data-folder-id="${folder.id}" title="Âú®Ê≠§Êñá‰ª∂Â§πÊñ∞Âª∫‰æøÁ≠æ" style="background:none;border:none;color:var(--theme-color);cursor:pointer;font-size:16px;padding:0 4px;">+</button>
                ${folder.id !== 'default' ? `<button class="delete-folder-btn" data-folder-id="${folder.id}" style="background:none;border:none;color:var(--text-muted);cursor:pointer;">√ó</button>` : ''}
              </div>
            </div>
            <div class="notes-folder-content ${folder.collapsed ? 'collapsed' : ''}">
              ${folderNotes.map(note => `
                <div class="notes-list-item ${currentNoteId === note.id ? 'active' : ''}" data-id="${note.id}" draggable="true">
                  <div class="notes-list-item-title">${note.title || 'Êó†Ê†áÈ¢ò'}</div>
                  <div class="notes-list-item-date">${note.date}</div>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      });
      
      list.innerHTML = html;
      bindNotesDragEvents();
    }

    function bindNotesDragEvents() {
      const noteItems = document.querySelectorAll('.notes-list-item');
      const folderHeaders = document.querySelectorAll('.notes-folder-header');
      
      noteItems.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          draggedItem = item;
          item.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });

        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
          document.querySelectorAll('.notes-list-item, .notes-folder-header').forEach(i => i.classList.remove('drag-over'));
          draggedItem = null;
        });
      });

      folderHeaders.forEach(header => {
        header.addEventListener('dragover', (e) => {
          e.preventDefault();
          if (draggedItem) {
            header.classList.add('drag-over');
          }
        });

        header.addEventListener('dragleave', () => {
          header.classList.remove('drag-over');
        });

        header.addEventListener('drop', (e) => {
          e.preventDefault();
          header.classList.remove('drag-over');
          
          if (draggedItem) {
            const noteId = draggedItem.dataset.id;
            const folderId = header.dataset.folderId;
            
            const note = notes.find(n => n.id === noteId);
            if (note) {
              note.folderId = folderId;
              saveData('notes', notes);
              renderNotes();
            }
          }
        });
      });
    }

    // function renderPinnedNotes() {
    //   const container = document.getElementById('pinnedNotes');
    //   const pinnedNotes = notes.filter(n => pinnedNoteIds.includes(n.id));
      
    //   container.innerHTML = pinnedNotes.map(note => {
    //     const lines = note.content.split('\n');
    //     const title = lines[0] || 'Êó†Ê†áÈ¢ò';
    //     const content = lines.slice(1).join('\n');
        
    //     return `
    //       <div class="pinned-note" data-id="${note.id}">
    //         <div class="pinned-note-title">${title}</div>
    //         ${content ? `<div class="pinned-note-content">${content}</div>` : ''}
    //         <div class="pinned-note-date">${note.date}</div>
    //       </div>
    //     `;
    //   }).join('');
    // }



    function renderPinnedNotes() {
      const container = document.getElementById('pinnedNotes');
      const pinnedNotes = notes.filter(n => pinnedNoteIds.includes(n.id));
      
      container.innerHTML = pinnedNotes.map(note => {
        const lines = note.content.split('\n');
        const title = lines[0] || 'Êó†Ê†áÈ¢ò';
        const content = lines.slice(1).join('\n');
        
        // Ê∏≤Êüì‰ªªÂä°ÂàóË°®
        let tasksHtml = '';
        if (note.tasks && note.tasks.length > 0) {
          tasksHtml = `
            <div class="pinned-note-tasks">
              ${note.tasks.map(task => `
                <div class="pinned-task-item ${task.completed ? 'completed' : ''}">
                  <div class="pinned-task-checkbox">
                    ${task.completed ? '‚úì' : ''}
                  </div>
                  <span>${escapeHtml(task.text)}</span>
                </div>
              `).join('')}
            </div>
          `;
        }
        
        return `
          <div class="pinned-note" data-id="${note.id}">
            <div class="pinned-note-title">${title}</div>
            ${content ? `<div class="pinned-note-content">${content}</div>` : ''}
            ${tasksHtml}
            <div class="pinned-note-date">${note.date}</div>
          </div>
        `;
      }).join('');
    }









    // function selectNote(id) {
    //   currentNoteId = id;
    //   const note = notes.find(n => n.id === id);
    //   const editor = document.getElementById('notesEditor');
      
    //   if (note) {
    //     editor.innerHTML = `<textarea placeholder="Âú®Ê≠§ÈîÆÂÖ•...">${note.content}</textarea>`;
    //     const textarea = editor.querySelector('textarea');
    //     textarea.addEventListener('input', (e) => {
    //       note.content = e.target.value;
    //       const firstLine = e.target.value.split('\n')[0];
    //       note.title = firstLine.slice(0, 30) || 'Êó†Ê†áÈ¢ò';
    //       saveData('notes', notes);
    //       renderNotes();
    //       renderPinnedNotes();
    //     });
    //     textarea.focus();
    //   } else {
    //     editor.innerHTML = '<div class="notes-editor-placeholder">Âú®Ê≠§ÈîÆÂÖ•‰ª•ÂàõÂª∫Êñ∞ÁöÑ‰æøÁ≠æ</div>';
    //   }
      
    //   renderNotes();
      
    //   const pinBtn = document.getElementById('pinNoteBtn');
    //   if (pinBtn && currentNoteId) {
    //     pinBtn.classList.toggle('active', pinnedNoteIds.includes(currentNoteId));
    //   }
    // }

    function selectNote(id) {
      currentNoteId = id;
      const note = notes.find(n => n.id === id);
      const editor = document.getElementById('notesEditor');
      
      if (note) {
        // ÂàùÂßãÂåñ‰ªªÂä°ÂàóË°®ÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ
        if (!note.tasks) {
          note.tasks = [];
        }
        
        // editor.innerHTML = `
        //   <textarea placeholder="Âú®Ê≠§ÈîÆÂÖ•...">${note.content}</textarea>
        //   <div class="task-list">
        //     <div class="task-list-header">
        //       <span class="task-list-title">‰ªªÂä°ÂàóË°®</span>
        //       <button class="add-task-btn" id="addTaskBtn">+ Ê∑ªÂä†‰ªªÂä°</button>
        //     </div>
        //     <div class="task-items" id="taskItems"></div>
        //   </div>
        // `;

        editor.innerHTML = `
          <textarea placeholder="Âú®Ê≠§ÈîÆÂÖ•..." id="noteTextarea">${note.content}</textarea>
          <div class="editor-resize-handle" id="editorResizeHandle" title="ÊãñÊãΩË∞ÉÊï¥Â§ßÂ∞è"></div>
          <div class="task-list">
            <div class="task-list-header">
              <span class="task-list-title">‰ªªÂä°ÂàóË°®</span>
              <button class="add-task-btn" id="addTaskBtn">+ Ê∑ªÂä†‰ªªÂä°</button>
            </div>
            <div class="task-items" id="taskItems"></div>
          </div>
        `;
        
        const textarea = editor.querySelector('textarea');
        textarea.addEventListener('input', (e) => {
          note.content = e.target.value;
          const firstLine = e.target.value.split('\n')[0];
          note.title = firstLine.slice(0, 30) || 'Êó†Ê†áÈ¢ò';
          saveData('notes', notes);
          renderNotes();
          renderPinnedNotes();
        });
        textarea.focus();
        
        // Ê∏≤Êüì‰ªªÂä°ÂàóË°®
        renderTaskList(note);
        
        // Ê∑ªÂä†‰ªªÂä°ÊåâÈíÆ‰∫ã‰ª∂
        document.getElementById('addTaskBtn').addEventListener('click', () => {
          addTask(note);
        });
        // ÂàùÂßãÂåñÂàÜÈöîÊù°ÊãñÊãΩÂäüËÉΩ
        initEditorResize();
        
      } else {
        editor.innerHTML = '<div class="notes-editor-placeholder">Âú®Ê≠§ÈîÆÂÖ•‰ª•ÂàõÂª∫Êñ∞ÁöÑ‰æøÁ≠æ</div>';
      }
      
      renderNotes();
      
      const pinBtn = document.getElementById('pinNoteBtn');
      if (pinBtn && currentNoteId) {
        pinBtn.classList.toggle('active', pinnedNoteIds.includes(currentNoteId));
      }
    }








    function addNote(folderId = 'default') {
      const now = new Date();
      const note = {
        id: Date.now().toString(),
        title: 'Êñ∞‰æøÁ≠æ',
        content: '',
        folderId: folderId,
        date: `${now.getFullYear()}/${String(now.getMonth() + 1).padStart(2, '0')}/${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`
      };
      notes.unshift(note);
      saveData('notes', notes);
      selectNote(note.id);
    }

    function deleteNote() {
      if (!currentNoteId) return;
      notes = notes.filter(n => n.id !== currentNoteId);
      pinnedNoteIds = pinnedNoteIds.filter(id => id !== currentNoteId);
      saveData('notes', notes);
      saveData('pinnedNoteIds', pinnedNoteIds);
      currentNoteId = null;
      selectNote(null);
      renderPinnedNotes();
    }

    function pinNote() {
      if (!currentNoteId) return;
      if (pinnedNoteIds.includes(currentNoteId)) {
        pinnedNoteIds = pinnedNoteIds.filter(id => id !== currentNoteId);
      } else {
        pinnedNoteIds.push(currentNoteId);
      }
      saveData('pinnedNoteIds', pinnedNoteIds);
      renderPinnedNotes();
      
      const pinBtn = document.getElementById('pinNoteBtn');
      if (pinBtn) {
        pinBtn.classList.toggle('active', pinnedNoteIds.includes(currentNoteId));
      }
    }

    function toggleNotesFullscreen() {
      const modal = document.getElementById('notesModal');
      isNotesFullscreen = !isNotesFullscreen;
      modal.classList.toggle('fullscreen', isNotesFullscreen);
      
      const btn = document.getElementById('expandNoteBtn');
      if (isNotesFullscreen) {
        btn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 14h6m0 0v6m0-6L3 21M20 10h-6m0 0V4m0 6l7-7"/>
          </svg>
        `;
      } else {
        btn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
          </svg>
        `;
      }
    }

    function addFolder() {
      const name = document.getElementById('folderNameInput').value.trim();
      if (name) {
        folders.push({
          id: Date.now().toString(),
          name: name,
          collapsed: false
        });
        saveData('folders', folders);
        renderNotes();
        document.getElementById('addFolderModal').classList.remove('show');
        document.getElementById('folderNameInput').value = '';
      }
    }



    // ==================== ÁºñËæëÂô®ÂàÜÈöîÊù°ÊãñÊãΩÂäüËÉΩ ====================
    function initEditorResize() {
      const handle = document.getElementById('editorResizeHandle');
      const textarea = document.getElementById('noteTextarea');
      const editor = document.getElementById('notesEditor');
      
      if (!handle || !textarea || !editor) return;
      
      let isResizing = false;
      let startY = 0;
      let startHeight = 0;
      
      handle.addEventListener('mousedown', (e) => {
        isResizing = true;
        startY = e.clientY;
        startHeight = textarea.offsetHeight;
        editor.classList.add('resizing');
        document.body.style.cursor = 'ns-resize';
        e.preventDefault();
      });
      
      document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;
        
        const deltaY = e.clientY - startY;
        const newHeight = Math.max(80, Math.min(startHeight + deltaY, editor.offsetHeight - 150));
        textarea.style.height = newHeight + 'px';
      });
      
      document.addEventListener('mouseup', () => {
        if (isResizing) {
          isResizing = false;
          editor.classList.remove('resizing');
          document.body.style.cursor = '';
        }
      });
      
      // Ëß¶Êë∏ËÆæÂ§áÊîØÊåÅ
      handle.addEventListener('touchstart', (e) => {
        isResizing = true;
        startY = e.touches[0].clientY;
        startHeight = textarea.offsetHeight;
        editor.classList.add('resizing');
        e.preventDefault();
      }, { passive: false });
      
      document.addEventListener('touchmove', (e) => {
        if (!isResizing) return;
        
        const deltaY = e.touches[0].clientY - startY;
        const newHeight = Math.max(80, Math.min(startHeight + deltaY, editor.offsetHeight - 150));
        textarea.style.height = newHeight + 'px';
      }, { passive: false });
      
      document.addEventListener('touchend', () => {
        if (isResizing) {
          isResizing = false;
          editor.classList.remove('resizing');
        }
      });
    }



    

        // ==================== ‰ªªÂä°ÂàóË°®ÂäüËÉΩ ====================
    let selectedTaskId = null;

    function renderTaskList(note) {
      const container = document.getElementById('taskItems');
      if (!container || !note.tasks) return;
      
      container.innerHTML = note.tasks.map(task => `
        <div class="task-item ${task.completed ? 'completed' : ''} ${selectedTaskId === task.id ? 'selected' : ''}" 
            data-task-id="${task.id}">
          <div class="task-checkbox">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
          </div>
          <div class="task-content">
            <div class="task-text">${escapeHtml(task.text)}</div>
          </div>
        </div>
      `).join('');
      
      // ÁªëÂÆö‰ªªÂä°ÁÇπÂáª‰∫ã‰ª∂
      container.querySelectorAll('.task-item').forEach(item => {
        const taskId = item.dataset.taskId;
        
        // ÁÇπÂáªcheckboxÂàáÊç¢ÂÆåÊàêÁä∂ÊÄÅ
        item.querySelector('.task-checkbox').addEventListener('click', (e) => {
          e.stopPropagation();
          toggleTaskComplete(note, taskId);
        });
        
        // ÁÇπÂáª‰ªªÂä°È°πÈÄâ‰∏≠
        item.addEventListener('click', (e) => {
          if (e.target.closest('.task-checkbox')) return;
          selectTask(taskId);
        });
        
        // ÂèåÂáªÁºñËæë‰ªªÂä°
        item.addEventListener('dblclick', (e) => {
          if (e.target.closest('.task-checkbox')) return;
          editTask(note, taskId);
        });
      });
    }

    function addTask(note) {
      const taskId = Date.now().toString();
      const newTask = {
        id: taskId,
        text: '',
        completed: false
      };
      note.tasks.push(newTask);
      saveData('notes', notes);
      renderTaskList(note);
      
      // Á´ãÂç≥ËøõÂÖ•ÁºñËæëÊ®°Âºè
      editTask(note, taskId);
    }

    function editTask(note, taskId) {
      const task = note.tasks.find(t => t.id === taskId);
      if (!task) return;
      
      const taskItem = document.querySelector(`.task-item[data-task-id="${taskId}"]`);
      if (!taskItem) return;
      
      const taskContent = taskItem.querySelector('.task-content');
      const originalText = task.text;
      
      taskContent.innerHTML = `<input type="text" class="task-input" value="${escapeHtml(task.text)}" placeholder="ËæìÂÖ•‰ªªÂä°ÂÜÖÂÆπ...">`;
      
      const input = taskContent.querySelector('.task-input');
      input.focus();
      input.select();
      
      const saveTask = () => {
        const newText = input.value.trim();
        if (newText) {
          task.text = newText;
          saveData('notes', notes);
          renderTaskList(note);
          renderPinnedNotes();
        } else if (!originalText) {
          // Êñ∞‰ªªÂä°Ê≤°ÊúâËæìÂÖ•ÂÜÖÂÆπÔºåÂà†Èô§ÂÆÉ
          note.tasks = note.tasks.filter(t => t.id !== taskId);
          saveData('notes', notes);
          renderTaskList(note);
        } else {
          // ÁºñËæëÊó∂Ê∏ÖÁ©∫ÔºåÊÅ¢Â§çÂéüÂÜÖÂÆπ
          renderTaskList(note);
        }
      };
      
      input.addEventListener('blur', saveTask);
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          input.blur();
        } else if (e.key === 'Escape') {
          task.text = originalText;
          renderTaskList(note);
        }
      });
    }

    function toggleTaskComplete(note, taskId) {
      const task = note.tasks.find(t => t.id === taskId);
      if (task) {
        task.completed = !task.completed;
        saveData('notes', notes);
        renderTaskList(note);
        renderPinnedNotes();
      }
    }

    function selectTask(taskId) {
      selectedTaskId = (selectedTaskId === taskId) ? null : taskId;
      const note = notes.find(n => n.id === currentNoteId);
      if (note) {
        renderTaskList(note);
      }
    }

    function deleteSelectedTask() {
      if (!selectedTaskId || !currentNoteId) return;
      
      const note = notes.find(n => n.id === currentNoteId);
      if (note && note.tasks) {
        note.tasks = note.tasks.filter(t => t.id !== selectedTaskId);
        selectedTaskId = null;
        saveData('notes', notes);
        renderTaskList(note);
        renderPinnedNotes();
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }












    // ==================== ‰∫ã‰ª∂ÁªëÂÆö ====================
    function bindEvents() {
      // ÊêúÁ¥¢
      document.getElementById('searchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') doSearch();
      });
      document.getElementById('searchSubmitBtn').addEventListener('click', doSearch);
      
      // ÊêúÁ¥¢ÂºïÊìéÂàáÊç¢
      document.getElementById('engineBtn').addEventListener('click', (e) => {
        e.stopPropagation();
        document.getElementById('engineDropdown').classList.toggle('show');
        document.getElementById('searchHistory').classList.remove('show');
      });
      
      document.querySelectorAll('.engine-option[data-engine]').forEach(opt => {
        opt.addEventListener('click', () => setEngine(opt.dataset.engine));
      });
      
      // ÊêúÁ¥¢ÂéÜÂè≤
      document.getElementById('searchInput').addEventListener('focus', showSearchHistory);
      document.getElementById('searchHistory').addEventListener('click', (e) => {
        const item = e.target.closest('.search-history-item');
        if (item) {
          document.getElementById('searchInput').value = item.dataset.query;
          document.getElementById('searchHistory').classList.remove('show');
        }
      });

      // Ê∏ÖÈô§ÊêúÁ¥¢ÂéÜÂè≤
      document.getElementById('searchHistory').addEventListener('click', (e) => {
        const clearBtn = e.target.closest('.search-history-clear');
        if (clearBtn) {
          e.stopPropagation();
          searchHistoryData = [];
          saveData('searchHistoryData', searchHistoryData);
          document.getElementById('searchHistory').classList.remove('show');
          showToast('ÊêúÁ¥¢ÂéÜÂè≤Â∑≤Ê∏ÖÈô§');
        }
      });



      
      // Alt + Êï∞Â≠óÂàáÊç¢ÊêúÁ¥¢ÂºïÊìé
      document.addEventListener('keydown', (e) => {
        if (e.altKey) {
          const engines = ['baidu', 'bing', 'google', 'yandex'];
          const num = parseInt(e.key);
          if (num >= 1 && num <= 4) {
            e.preventDefault();
            setEngine(engines[num - 1]);
          }
        }
        
        if (e.key === 'Tab' && document.activeElement === document.getElementById('searchInput')) {
          if (settings.tabBehavior === 'engine') {
            e.preventDefault();
            const engines = ['baidu', 'bing', 'google', 'yandex'];
            const currentIndex = engines.indexOf(currentEngine);
            const nextIndex = e.shiftKey 
              ? (currentIndex - 1 + engines.length) % engines.length 
              : (currentIndex + 1) % engines.length;
            setEngine(engines[nextIndex]);
          }
        }
      });
      
      
      // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠‰∏ãÊãâËèúÂçïÂíåÂè≥ÈîÆËèúÂçï
      document.addEventListener('click', (e) => {
        // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÊêúÁ¥¢Ê°ÜÂÜÖÈÉ®Ôºå‰∏çÂÖ≥Èó≠ÊêúÁ¥¢ÂéÜÂè≤
        if (!e.target.closest('.search-container')) {
          document.getElementById('searchHistory').classList.remove('show');
        }
        document.getElementById('engineDropdown').classList.remove('show');
        document.getElementById('contextMenu').classList.remove('show');
        document.getElementById('workspaceContextMenu').classList.remove('show');
      });
      // Âè≥ÈîÆÊâìÂºÄÂ∑•‰ΩúÂå∫
      document.addEventListener('contextmenu', (e) => {
        const target = e.target;
        
        const isExcluded = target.closest('.workspace-overlay') || 
                          target.closest('.settings-panel') || 
                          target.closest('.notes-modal') ||
                          target.closest('.hitokoto-section') ||
                          target.closest('.dock-bar') ||
                          target.closest('.search-section') ||
                          target.closest('.add-site-modal') ||
                          target.closest('.hitokoto-modal') ||
                          target.closest('.add-folder-modal') ||
                          target.closest('.pinned-notes') ||
                          target.closest('.top-right-buttons');
        
        if (!isExcluded) {
          e.preventDefault();
          document.getElementById('workspaceOverlay').classList.add('show');
        }
      });

      // Dock Ê†èÂè≥ÈîÆËèúÂçï
      document.getElementById('dockBar').addEventListener('contextmenu', (e) => {
        e.preventDefault();
        e.stopPropagation();
        
        const dockItem = e.target.closest('.dock-item');
        contextMenuTarget = dockItem;
        
        const contextMenu = document.getElementById('contextMenu');
        // contextMenu.style.left = e.clientX + 'px';
        // contextMenu.style.top = e.clientY + 'px';
        // contextMenu.classList.add('show');
        contextMenu.style.left = e.clientX + 'px';
        contextMenu.classList.add('show');
        // Ê£ÄÊü•ËèúÂçïÊòØÂê¶Ë∂ÖÂá∫Â±èÂπïÂ∫ïÈÉ®ÔºåÂ¶ÇÊûúË∂ÖÂá∫ÂàôÂêë‰∏äÊòæÁ§∫
        const menuHeight = contextMenu.offsetHeight;
        const windowHeight = window.innerHeight;
        if (e.clientY + menuHeight > windowHeight) {
          contextMenu.style.top = (e.clientY - menuHeight) + 'px';
        } else {
          contextMenu.style.top = e.clientY + 'px';
        }
      });

      // Âè≥ÈîÆËèúÂçïÊìç‰Ωú
      document.getElementById('contextMenu').addEventListener('click', (e) => {
        const action = e.target.closest('.context-menu-item')?.dataset.action;
        
        if (action === 'add') {
          document.getElementById('addSiteModal').classList.add('show');
          document.getElementById('addSiteModal').dataset.target = 'dock';
        } else if (action === 'delete' && contextMenuTarget) {
          const index = parseInt(contextMenuTarget.dataset.index);
          if (!isNaN(index)) {
            const item = dockItems[index];
            // ‰øùÊä§"Â∫îÁî®"ÊåâÈíÆ‰∏çÂèØÂà†Èô§
            if (item && item.action === 'apps') {
              showToast('"Â∫îÁî®"ÊåâÈíÆÊó†Ê≥ïÂà†Èô§', 'error');
            } else {
              dockItems.splice(index, 1);
              saveData('dockItems', dockItems);
              renderDockBar();
              showToast('Â∫îÁî®Â∑≤Âà†Èô§');
            }
          }
        }
        
        document.getElementById('contextMenu').classList.remove('show');
        contextMenuTarget = null;
      });
      
      // ESC ÂÖ≥Èó≠
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          document.getElementById('workspaceOverlay').classList.remove('show');
          document.getElementById('settingsPanel').classList.remove('show');
          document.getElementById('settingsOverlay').classList.remove('show');
          document.getElementById('notesModal').classList.remove('show');
          document.getElementById('addSiteModal').classList.remove('show');
          document.getElementById('editSiteModal').classList.remove('show');
          document.getElementById('hitokotoModal').classList.remove('show');
          document.getElementById('addFolderModal').classList.remove('show');
          document.getElementById('contextMenu').classList.remove('show');
          document.getElementById('workspaceContextMenu').classList.remove('show');
          isNotesFullscreen = false;
          document.getElementById('notesModal').classList.remove('fullscreen');
        }
      });
      
      // ÁÇπÂáªÂ∑•‰ΩúÂå∫Á©∫ÁôΩÂÖ≥Èó≠
      document.getElementById('workspaceOverlay').addEventListener('click', (e) => {
        if (e.target === document.getElementById('workspaceOverlay')) {
          document.getElementById('workspaceOverlay').classList.remove('show');
        }
      });
      
      // Â∑•‰ΩúÂå∫È°πÁõÆÁÇπÂáª
      document.getElementById('workspaceGrid').addEventListener('click', (e) => {
        const deleteBtn = e.target.closest('.workspace-item-delete');
        if (deleteBtn) {
          e.preventDefault();
          e.stopPropagation();
          const index = parseInt(deleteBtn.dataset.index);
          if (!isNaN(index)) {
            sites.splice(index, 1);
            saveData('sites', sites);
            renderWorkspaceGrid();
          }
          return;
        }
        
        const item = e.target.closest('.workspace-item');
        if (!item) return;
        
        if (item.dataset.action === 'notes') {
          document.getElementById('workspaceOverlay').classList.remove('show');
          document.getElementById('notesModal').classList.add('show');
        } else if (item.dataset.action === 'theme') {
          settings.darkMode = settings.darkMode === 'on' ? 'off' : 'on';
          saveData('settings', settings);
          applyDarkMode();  // üîß Ê∑ªÂä†Ëøô‰∏ÄË°å
          showToast(settings.darkMode === 'on' ? 'Â∑≤ÂàáÊç¢Âà∞Ê∑±Ëâ≤Ê®°Âºè' : 'Â∑≤ÂàáÊç¢Âà∞ÊµÖËâ≤Ê®°Âºè');
        } else if (item.id === 'addSiteBtn') {
          document.getElementById('addSiteModal').classList.add('show');
          document.getElementById('addSiteModal').dataset.target = 'workspace';
        }
      });

      // workspaceÂ∫îÁî®Âè≥ÈîÆËèúÂçï
      document.getElementById('workspaceGrid').addEventListener('contextmenu', (e) => {
        const item = e.target.closest('.workspace-item');
        // ÊéíÈô§Ê∑ªÂä†ÊåâÈíÆ
        if (!item || item.id === 'addSiteBtn') return;
        
        e.preventDefault();
        e.stopPropagation();
        
        workspaceContextMenuTarget = item;
        
        const contextMenu = document.getElementById('workspaceContextMenu');
        contextMenu.style.left = e.clientX + 'px';
        
        // Ê£ÄÊü•ËèúÂçïÊòØÂê¶Ë∂ÖÂá∫Â±èÂπïÂ∫ïÈÉ®ÔºåÂ¶ÇÊûúË∂ÖÂá∫ÂàôÂêë‰∏äÊòæÁ§∫
        contextMenu.classList.add('show');
        const menuHeight = contextMenu.offsetHeight;
        const windowHeight = window.innerHeight;
        if (e.clientY + menuHeight > windowHeight) {
          contextMenu.style.top = (e.clientY - menuHeight) + 'px';
        } else {
          contextMenu.style.top = e.clientY + 'px';
        }
      });

      // workspaceÂè≥ÈîÆËèúÂçïÊìç‰Ωú
      document.getElementById('workspaceContextMenu').addEventListener('click', (e) => {
        const action = e.target.closest('.context-menu-item')?.dataset.action;
        
        if (!workspaceContextMenuTarget) return;
        
        const index = parseInt(workspaceContextMenuTarget.dataset.index);
        
        if (action === 'edit' && !isNaN(index)) {
          // ÁºñËæëÂ∫îÁî®
          const site = sites[index];
          if (site && !site.isSpecial) {
            editingSiteIndex = index;
            document.getElementById('editSiteNameInput').value = site.name || '';
            document.getElementById('editSiteUrlInput').value = site.url || '';
            document.getElementById('editSiteIconInput').value = site.icon || '';
            document.getElementById('editSiteModal').classList.add('show');
          } else if (site && site.isSpecial) {
            showToast('Á≥ªÁªüÂ∫îÁî®Êó†Ê≥ïÁºñËæë', 'error');
          }
        } else if (action === 'addToDock' && !isNaN(index)) {
          // Ê∑ªÂä†Âà∞‰æøÊç∑Ê†è
          const site = sites[index];
          if (site) {
            // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®
            const exists = dockItems.some(item => 
              (item.url && item.url === site.url) || 
              (item.action && site.url === '#' + item.action)
            );
            
            if (exists) {
              showToast('ËØ•Â∫îÁî®Â∑≤Âú®‰æøÊç∑Ê†è‰∏≠', 'error');
            } else {
              const newDockItem = {
                name: site.name,
                icon: site.icon,
                color: `linear-gradient(135deg, ${site.color}, ${site.color})`
              };
              
              if (site.url === '#notes') {
                newDockItem.action = 'notes';
              } else if (site.url === '#theme') {
                newDockItem.action = 'theme';
              } else {
                newDockItem.url = site.url;
              }
              
              dockItems.push(newDockItem);
              saveData('dockItems', dockItems);
              renderDockBar();
              showToast('Â∑≤Ê∑ªÂä†Âà∞‰æøÊç∑Ê†è');
            }
          }
        } else if (action === 'delete' && !isNaN(index)) {
          // Âà†Èô§Â∫îÁî®
          const site = sites[index];
          if (site && site.isSpecial) {
            showToast('Á≥ªÁªüÂ∫îÁî®Êó†Ê≥ïÂà†Èô§', 'error');
          } else {
            sites.splice(index, 1);
            saveData('sites', sites);
            renderWorkspaceGrid();
            showToast('Â∫îÁî®Â∑≤Âà†Èô§');
          }
        }
        
        document.getElementById('workspaceContextMenu').classList.remove('show');
        workspaceContextMenuTarget = null;
      });

      // Dock Ê†èÁÇπÂáª
      document.getElementById('dockBar').addEventListener('click', (e) => {
        const item = e.target.closest('.dock-item');
        if (!item) return;
        
        const action = item.dataset.action;
        if (action === 'apps') {
          document.getElementById('workspaceOverlay').classList.add('show');
        } else if (action === 'notes') {
          document.getElementById('notesModal').classList.add('show');
        } else if (action === 'theme') {
          settings.darkMode = settings.darkMode === 'on' ? 'off' : 'on';
          saveData('settings', settings);
          applyDarkMode();  // üîß Ê∑ªÂä†Ëøô‰∏ÄË°åÔºåÁ´ãÂç≥Ê∑±Ëâ≤Â∫îÁî®
          showToast(settings.darkMode === 'on' ? 'Â∑≤ÂàáÊç¢Âà∞Ê∑±Ëâ≤Ê®°Âºè' : 'Â∑≤ÂàáÊç¢Âà∞ÊµÖËâ≤Ê®°Âºè');
        }
      });
      
      // ËÆæÁΩÆÈù¢Êùø
      document.getElementById('settingsBtn').addEventListener('click', () => {
        document.getElementById('settingsPanel').classList.add('show');
        document.getElementById('settingsOverlay').classList.add('show');
      });
      
      document.getElementById('settingsClose').addEventListener('click', () => {
        document.getElementById('settingsPanel').classList.remove('show');
        document.getElementById('settingsOverlay').classList.remove('show');
      });
      
      document.getElementById('settingsOverlay').addEventListener('click', () => {
        document.getElementById('settingsPanel').classList.remove('show');
        document.getElementById('settingsOverlay').classList.remove('show');
      });
      
      document.getElementById('darkModeSelect').addEventListener('change', (e) => {
      settings.darkMode = e.target.value;
      saveData('settings', settings);
      applyDarkMode();
    });
      
      // Toggle ÂºÄÂÖ≥
      document.querySelectorAll('.toggle').forEach(toggle => {
        toggle.addEventListener('click', () => {
          toggle.classList.toggle('active');
          const id = toggle.id;
          if (id === 'autoClearToggle') settings.autoClear = toggle.classList.contains('active');
          if (id === 'searchHistoryToggle') settings.searchHistory = toggle.classList.contains('active');
          if (id === 'dockToggle') {
            settings.showDock = toggle.classList.contains('active');
            document.getElementById('dockBar').style.display = settings.showDock ? 'flex' : 'none';
          }
          if (id === 'newTabToggle') settings.newTab = toggle.classList.contains('active');
          if (id === 'vignetteToggle') {
            settings.vignette = toggle.classList.contains('active');
            document.getElementById('vignetteLayer').style.display = settings.vignette ? 'block' : 'none';
          }
          saveData('settings', settings);
        });
      });
      
      // È¢úËâ≤ÈÄâÊã©
      document.querySelectorAll('.color-option').forEach(opt => {
        opt.addEventListener('click', () => {
          document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
          opt.classList.add('active');
          settings.themeColor = opt.dataset.color;
          document.documentElement.style.setProperty('--theme-color', settings.themeColor);
          saveData('settings', settings);
        });
      });
      
      // Â£ÅÁ∫∏ÈÄâÊã©
      document.getElementById('wallpaperGrid').addEventListener('click', (e) => {
        const item = e.target.closest('.wallpaper-item');
        if (item) setWallpaper(item.dataset.url);
      });
      
      // ‰∏ä‰º†Â£ÅÁ∫∏
      document.getElementById('uploadWallpaperBtn').addEventListener('click', () => {
        document.getElementById('wallpaperFileInput').click();
      });
      
      document.getElementById('wallpaperFileInput').addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            setWallpaper(event.target.result);
          };
          reader.readAsDataURL(file);
        }
      });
      
      // ‰æøÁ≠æ
      document.getElementById('closeNotesBtn').addEventListener('click', () => {
        document.getElementById('notesModal').classList.remove('show');
        isNotesFullscreen = false;
        document.getElementById('notesModal').classList.remove('fullscreen');
      });
      
      document.getElementById('addNoteBtn').addEventListener('click', () => addNote());
      document.getElementById('deleteNoteBtn').addEventListener('click', deleteNote);
      document.getElementById('pinNoteBtn').addEventListener('click', pinNote);
      document.getElementById('expandNoteBtn').addEventListener('click', toggleNotesFullscreen);
      
      document.getElementById('notesList').addEventListener('click', (e) => {
        // Âú®Êñá‰ª∂Â§π‰∏≠Êñ∞Âª∫‰æøÁ≠æ
        const addNoteBtn = e.target.closest('.add-note-to-folder-btn');
        if (addNoteBtn) {
          e.stopPropagation();
          const folderId = addNoteBtn.dataset.folderId;
          addNote(folderId);
          return;
        }

        const deleteFolderBtn = e.target.closest('.delete-folder-btn');
        
        if (deleteFolderBtn) {
          e.stopPropagation();
          const folderId = deleteFolderBtn.dataset.folderId;


          notes.forEach(note => {
            if (note.folderId === folderId) {
              note.folderId = 'default';
            }
          });
          folders = folders.filter(f => f.id !== folderId);
          saveData('folders', folders);
          saveData('notes', notes);
          renderNotes();
          return;
        }
        
        const folderHeader = e.target.closest('.notes-folder-header');
        if (folderHeader && !e.target.closest('.delete-folder-btn')) {
          const folderId = folderHeader.dataset.folderId;
          const folder = folders.find(f => f.id === folderId);
          if (folder) {
            folder.collapsed = !folder.collapsed;
            saveData('folders', folders);
            renderNotes();
          }
          return;
        }
        
        const item = e.target.closest('.notes-list-item');
        if (item) selectNote(item.dataset.id);
      });
      

      // ‰æøÁ≠æÊî∂Á∫≥ÂàáÊç¢
      document.getElementById('pinnedNotesToggle').addEventListener('click', () => {
        document.getElementById('pinnedNotesWrapper').classList.toggle('collapsed');
      });



      // Âõ∫ÂÆö‰æøÁ≠æÁÇπÂáª
      document.getElementById('pinnedNotes').addEventListener('click', (e) => {
        const note = e.target.closest('.pinned-note');
        if (note) {
          document.getElementById('notesModal').classList.add('show');
          selectNote(note.dataset.id);
        }
      });
      
      // Ê∑ªÂä†Êñá‰ª∂Â§π
      document.getElementById('addFolderBtn').addEventListener('click', () => {
        document.getElementById('addFolderModal').classList.add('show');
      });
      
      document.getElementById('cancelAddFolder').addEventListener('click', () => {
        document.getElementById('addFolderModal').classList.remove('show');
        document.getElementById('folderNameInput').value = '';
      });
      
      document.getElementById('confirmAddFolder').addEventListener('click', addFolder);
      
      // ‰∏ÄË®Ä
      document.getElementById('hitokoto').addEventListener('click', renderHitokoto);
      document.getElementById('hitokoto').addEventListener('contextmenu', (e) => {
        e.preventDefault();
        e.stopPropagation();
        renderHitokotoList();
        document.getElementById('hitokotoModal').classList.add('show');
      });
      
      document.getElementById('hitokotoSettingsBtn').addEventListener('click', () => {
        renderHitokotoList();
        document.getElementById('hitokotoModal').classList.add('show');
      });
      
      document.getElementById('closeHitokotoModal').addEventListener('click', () => {
        document.getElementById('hitokotoModal').classList.remove('show');
      });
      
      document.getElementById('addHitokotoBtn').addEventListener('click', () => {
        const input = document.getElementById('newHitokotoInput');
        const text = input.value.trim();
        if (text) {
          hitokotoList.push(text);
          saveData('hitokotoList', hitokotoList);
          input.value = '';
          renderHitokotoList();
        }
      });
      
      document.getElementById('hitokotoList').addEventListener('click', (e) => {
        const btn = e.target.closest('.hitokoto-item-delete');
        if (btn) {
          const index = parseInt(btn.dataset.index);
          hitokotoList.splice(index, 1);
          saveData('hitokotoList', hitokotoList);
          renderHitokotoList();
        }
      });
      
      // Ê∑ªÂä†Á´ôÁÇπ
      document.getElementById('cancelAddSite').addEventListener('click', () => {
        document.getElementById('addSiteModal').classList.remove('show');
      });
      
      document.getElementById('confirmAddSite').addEventListener('click', () => {
        const name = document.getElementById('siteNameInput').value.trim();
        const url = document.getElementById('siteUrlInput').value.trim();
        const icon = document.getElementById('siteIconInput').value.trim() || 'üîó';
        const target = document.getElementById('addSiteModal').dataset.target;
        
        if (name && url) {
          const newSite = {
            name,
            url: url.startsWith('http') ? url : `https://${url}`,
            icon,
            color: `hsl(${Math.random() * 360}, 70%, 50%)`
          };

          if (target === 'dock') {
            dockItems.push({
              ...newSite,
              color: `linear-gradient(135deg, ${newSite.color}, ${newSite.color})`
            });
            saveData('dockItems', dockItems);
            renderDockBar();
          } else {
            sites.push(newSite);
            saveData('sites', sites);
            renderWorkspaceGrid();
          }
          
          document.getElementById('addSiteModal').classList.remove('show');
          document.getElementById('siteNameInput').value = '';
          document.getElementById('siteUrlInput').value = '';
          document.getElementById('siteIconInput').value = '';
        }
      });

      // ÁºñËæëÁ´ôÁÇπ
      document.getElementById('cancelEditSite').addEventListener('click', () => {
        document.getElementById('editSiteModal').classList.remove('show');
        editingSiteIndex = -1;
      });
      
      document.getElementById('confirmEditSite').addEventListener('click', () => {
        if (editingSiteIndex < 0 || editingSiteIndex >= sites.length) return;
        
        const name = document.getElementById('editSiteNameInput').value.trim();
        const url = document.getElementById('editSiteUrlInput').value.trim();
        const icon = document.getElementById('editSiteIconInput').value.trim() || 'üîó';
        
        if (name && url) {
          sites[editingSiteIndex].name = name;
          sites[editingSiteIndex].url = url.startsWith('http') ? url : `https://${url}`;
          sites[editingSiteIndex].icon = icon;
          
          saveData('sites', sites);
          renderWorkspaceGrid();
          
          document.getElementById('editSiteModal').classList.remove('show');
          document.getElementById('editSiteNameInput').value = '';
          document.getElementById('editSiteUrlInput').value = '';
          document.getElementById('editSiteIconInput').value = '';
          editingSiteIndex = -1;
          
          showToast('Â∫îÁî®Â∑≤Êõ¥Êñ∞');
        }
      });

      // Êï∞ÊçÆÁÆ°ÁêÜÊåâÈíÆ
      document.getElementById('exportDataBtn').addEventListener('click', exportData);
      
      document.getElementById('importDataBtn').addEventListener('click', () => {
        document.getElementById('importFileInput').click();
      });
      
      document.getElementById('importFileInput').addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          importData(file);
        }
      });
      
      document.getElementById('resetDataBtn').addEventListener('click', resetAllData);

      // ÂÖ≥‰∫éÂºπÁ™ó
      document.getElementById('openAboutBtn').addEventListener('click', openAboutModal);
      document.getElementById('aboutCloseBtn').addEventListener('click', closeAboutModal);
      document.getElementById('aboutModalOverlay').addEventListener('click', closeAboutModal);

      // ÂàùÂßãÂåñÊªöÂä®ÊïàÊûú
      setupAboutScrollEffect();




      // ÂæÆ‰ø°Áæ§ÂºπÁ™ó
      document.getElementById('openWechatModal').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('wechatModalOverlay').classList.add('show');
        document.getElementById('wechatModal').classList.add('show');
      });

      document.getElementById('wechatModalClose').addEventListener('click', () => {
        document.getElementById('wechatModalOverlay').classList.remove('show');
        document.getElementById('wechatModal').classList.remove('show');
      });

      document.getElementById('wechatModalOverlay').addEventListener('click', () => {
        document.getElementById('wechatModalOverlay').classList.remove('show');
        document.getElementById('wechatModal').classList.remove('show');
      });


      // ‰ªªÂä°Âà†Èô§Âø´Êç∑ÈîÆ
      document.addEventListener('keydown', (e) => {
        if ((e.key === 'Backspace' || e.key === 'Delete') && selectedTaskId) {
          // Á°Æ‰øù‰∏çÊòØÂú®ËæìÂÖ•Ê°Ü‰∏≠
          if (document.activeElement.tagName !== 'INPUT' && 
              document.activeElement.tagName !== 'TEXTAREA') {
            e.preventDefault();
            deleteSelectedTask();
          }
        }
      });

    }

    // ÂàùÂßãÂåñ
    init();
  </script>
</body>
</html>
